import{_ as p,f as _,h as E}from"./func.33cfa174.js";import{o as r,c,a as s,t as h,n as g,r as m,w as S,v as L,F as f,b,d as k,$ as C,e as J,f as U,g as A,h as x,i as M,j as N,k as D,l as $,m as P}from"./vendor.93b10dc6.js";const F={props:["story"],emits:["hidemenu","focusstory","unfoldevent"],data(){return{focused:!1,lang:_.l,server:_.server}},mounted(){_.storyFile==this.story.storyTxt&&(this.focused=!0,this.$emit("unfoldevent"))},methods:{loadStory(n){var t="s="+this.server;t=t+"&f="+n,window.location.search=t}}},B=["id"],K={class:"storycode xst"},H={class:"storyname nt"};function V(n,t,o,l,e,a){return r(),c("div",{class:g({story:!0,storyFocused:e.focused,nt:!0}),id:o.story.storyId,onClick:t[0]||(t[0]=i=>a.loadStory(o.story.storyTxt))},[s("div",K,h(o.story.storyCode)+" "+h(o.story.avgTag),1),s("div",H,h(o.story.storyName),1)],10,B)}var W=p(F,[["render",V]]);const q={props:["event","eventid"],emits:["hidemenu","focusStory"],data(){return{collapsed:!0}},components:{Storymenu:W}},G={class:"event"},Y={class:"stories"};function Q(n,t,o,l,e,a){const i=m("Storymenu");return r(),c("div",G,[s("div",{class:g({eventname:!0,eventnamehl:!e.collapsed,lt:!0})},h(o.event.name),3),S(s("div",Y,[(r(!0),c(f,null,b(o.event.infoUnlockDatas,(u,d)=>(r(),k(i,{story:u,onUnfoldevent:t[0]||(t[0]=y=>{e.collapsed=!1,n.$emit("focusStory")}),key:d},null,8,["story"]))),128))],512),[[L,!e.collapsed]])])}var X=p(q,[["render",Q]]);const Z={zh_CN:"\u7B80\u4E2D\u670D(CN)",en_US:"Global Server(EN)",ja_JP:"\u65E5\u672C\u30B5\u30FC\u30D0\u30FC(JP)",ko_KR:"\uD55C\uAD6D \uC11C\uBC84(KR)",zh_TW:"\u7E41\u4E2D\u670D(TW)"},ee={zh_CN:"\u5F53\u524D\u8BED\u8A00",en_US:"Current Language",ja_JP:"\u73FE\u5728\u306E\u8A00\u8A9E",ko_KR:"\uD604\uC7AC \uC5B8\uC5B4",zh_TW:"\u7576\u524D\u8A9E\u8A00"},te={zh_CN:"\u8BF7\u4ECE\u76EE\u5F55\u4E2D\u9009\u62E9\u6545\u4E8B\u67E5\u770B",en_US:"Select the story you wanna view from the menu",ja_JP:"Select the story you wanna view from the menu",ko_KR:"Select the story you wanna view from the menu",zh_TW:"\u8ACB\u5F9E\u76EE\u9304\u4E2D\u9078\u64C7\u6545\u4E8B\u67E5\u770B"},ne={zh_CN:"\u4E3B\u9898\u66F2",en_US:"Maintheme",ja_JP:"Maintheme",ko_KR:"Maintheme",zh_TW:"\u4E3B\u9898\u66F2"},se={zh_CN:"\u522B\u4F20",en_US:"Sidestory",ja_JP:"Sidestory",ko_KR:"Sidestory",zh_TW:"\u522B\u4F20"},oe={zh_CN:"\u6545\u4E8B\u96C6",en_US:"Storyset",ja_JP:"Storyset",ko_KR:"Storyset",zh_TW:"\u6545\u4E8B\u96C6"},re={zh_CN:"\u5E72\u5458\u5BC6\u5F55",en_US:"Operators' Records",ja_JP:"Operators' Records",ko_KR:"Operators' Records",zh_TW:"\u5E79\u54E1\u5BC6\u9304"},ie={zh_CN:"\u8BBE\u7F6E",en_US:"Settings",ja_JP:"Settings",ko_KR:"Settings",zh_TW:"\u8BBE\u7F6E"},le={zh_CN:"\u91CD\u7F6E\u6240\u6709\u8BBE\u7F6E",en_US:"Reset All Settings",ja_JP:"Reset All Settings",ko_KR:"Reset All Settings",zh_TW:"\u91CD\u7F6E\u6240\u6709\u8BBE\u7F6E"},ae={zh_CN:"\u535A\u58EB\u79F0\u547C",en_US:"Doctor's Name",ja_JP:"\u30C9\u30AF\u30BF\u30FC\u306E\u540D\u524D",ko_KR:"Doctor's Name",zh_TW:"\u535A\u58EB\u7A31\u547C"},ce={zh_CN:"\u663E\u793A\u7A7A\u767D\u5206\u5272\u884C",en_US:"Show Blank Seperation Line",ja_JP:"Show Blank Seperation Line",ko_KR:"Show Blank Seperation Line",zh_TW:"\u986F\u793A\u7A7A\u767D\u5206\u5272\u884C"},ue={zh_CN:"\u9690\u85CF\u91CD\u590D\u4EBA\u540D",en_US:"Hide Duplicate Names",ja_JP:"Hide Duplicate Names",ko_KR:"Hide Duplicate Names",zh_TW:"\u96B1\u85CF\u91CD\u8907\u4EBA\u540D"},_e={zh_CN:"\u5E94\u7528\u8BBE\u7F6E",en_US:"Apply Setting",ja_JP:"Apply Setting",ko_KR:"Apply Setting",zh_TW:"\u5E94\u7528\u8BBE\u7F6E"},de={zh_CN:"\u8FD4\u56DE\u76EE\u5F55",en_US:"Return to Menu",ja_JP:"Return to Menu",ko_KR:"Return to Menu",zh_TW:"\u8FD4\u56DE\u76EE\u9304"};var j={server:Z,currentLang:ee,selectStory:te,main:ne,ss:se,mini:oe,or:re,setting:ie,clear:le,dr:ae,showDelay:ce,hideName:ue,save:_e,home:de};const he={data(){return{data:{},chardict:{},eventList:{},lang:_.l,server:_.server,i18n:j,showMenu:!0,showLangSelect:!1}},created(){C.getJSON("https://raw.githubusercontent.com/Kengxxiao/ArknightsGameData/master/"+this.server+"/gamedata/excel/story_review_table.json").done(n=>{this.data=n,C.getJSON("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+this.server+"/chardict.json").done(t=>{this.chardict=t,this.eventList=this.getEventList(this.data,this.chardict)})})},mounted(){_.focus()},methods:{serverSwitch(n){var t="s="+n;window.location.search=t},getEventList(n,t){var o=[],l;for(l in n)if(n[l].entryType=="MAINLINE")o.push(n[l]);else if(n[l].entryType=="ACTIVITY")o.push(n[l]);else if(n[l].entryType=="MINI_ACTIVITY")o.push(n[l]);else if(n[l].entryType=="NONE"){var e=l.split("_")[1],a=l.split("_")[3];n[l].name=t[e].name+" - "+a,o.push(n[l])}return o},focusStory(){_.focus()},home(){window.location.search="?s="+this.server}},components:{Eventmenu:X}},me={id:"sidebar"},ve={id:"currentLang",class:"currentLang lt"},pe=s("span",{class:"material-icons",style:{"margin-right":"5px"}},"language",-1),ye={id:"langSelect",class:"langSelect lt"},ge=["onClick"],fe=s("span",{class:"material-icons"}," menu_open ",-1),Se={class:"home"};function be(n,t,o,l,e,a){const i=m("Eventmenu");return r(),c("div",me,[s("div",{class:g({menuButton:!0,"material-icons":!0,menuButtonR:e.showMenu}),onClick:t[0]||(t[0]=u=>{e.showMenu=!e.showMenu})},"chevron_right",2),s("div",{class:g({sidebar:!0,sidebarhidden:!e.showMenu})},[s("div",ve,[s("div",{style:{display:"flex","align-items":"center","justify-content":"center"},onClick:t[1]||(t[1]=u=>e.showLangSelect=!e.showLangSelect)},[pe,s("span",null,h(e.i18n.server[e.server]),1)]),S(s("div",ye,[(r(!0),c(f,null,b(e.i18n.server,(u,d,y)=>(r(),c("div",{onClick:w=>a.serverSwitch(d),key:y},h(u),9,ge))),128))],512),[[L,e.showLangSelect]])]),s("div",{class:"homepage nt",onClick:t[2]||(t[2]=u=>a.home())},[fe,s("span",Se,h(e.i18n.home[e.lang]),1)]),(r(!0),c(f,null,b(e.eventList,(u,d)=>(r(),k(i,{class:"event",id:u.id,event:u,lang:e.lang,onHidemenu:t[3]||(t[3]=y=>e.showMenu=!1),key:d},null,8,["id","event","lang"]))),128))],2)])}var ke=p(he,[["render",be]]);const we={data(){return{doctor:_.doctor,i18n:j,lang:_.l,targetLang:_.l,show:this.doctor=="{@nickname}",hidetip:_.hidetip,showDelay:_.showDelay,hideName:_.hideName,langList:_.langList}},methods:{save(){window.localStorage.setItem("doctor",this.doctor),window.localStorage.setItem("showDelay",this.showDelay),window.localStorage.setItem("hideName",this.hideName),window.localStorage.setItem("lang",this.targetLang),window.location.href=window.location.href},clearSetting(){window.localStorage.clear(),window.location.href=window.location.href},hide(){this.hidetip=!0,window.localStorage.setItem("hidetip",!0)},getJSONFile(){return"https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+this.lang+"/gamedata/story/"+_.storyFile+".json"},getUserAgent(){return window.navigator.userAgent},getWidth(){return C(window).width()}}},xe={id:"setting"},Te={class:"warmtip",style:{"background-color":"rgb(255, 255, 0)",color:"#000",padding:"5px"}},Le=s("span",{style:{float:"left","margin-left":"20px"}},[x("If you like this project, please give me a star "),s("a",{href:"https://github.com/050644zf/ArknightsStoryTextReader",style:{color:"rgb(32, 32, 184)"}},"here"),x("!"),s("br"),x("If you have any issues or feedbacks please summit them "),s("a",{href:"https://github.com/050644zf/ArknightsStoryTextReader/issues",style:{color:"rgb(32, 32, 184)"}},"here"),x(".")],-1),Ne=s("div",{style:{clear:"both"}},null,-1),$e={class:"settingtitle nt"},Ce=s("span",{class:"material-icons clearbutton",style:{float:"right",padding:"4px"}},"delete",-1),ze={class:"settingtitle nt",style:{float:"right","font-weight":"normal"}},je=s("div",{style:{clear:"both"}},null,-1),Ie={class:g({settingoptions:!0,nt:!0})},Ue=s("span",{class:"material-icons"},"public",-1),Ae=s("div",{style:{clear:"both"}},null,-1),Me={style:{float:"left"}},Oe=s("div",{style:{clear:"both"}},null,-1),Re={style:{float:"left"}},Ee=s("div",{style:{clear:"both"}},null,-1),Je={style:{float:"left"}},De=s("div",{style:{clear:"both"}},null,-1),Pe={style:{float:"left","font-weight":"bold"}},Fe=s("span",{class:"material-icons",style:{float:"left"}},"save_alt",-1),Be=s("div",{style:{clear:"both"}},null,-1),Ke=s("span",{class:"xxst",style:{"font-weight":"bold",color:"dimgray"}}," Developer Info/Options (Please attach these info with your issues) ",-1),He={class:"xxst",style:{color:"dimgray"}},Ve=x(" Current JsonFile:"),We=s("br",null,null,-1),qe=s("br",null,null,-1),Ge=x(" Browser Info:"),Ye=s("br",null,null,-1),Qe=s("br",null,null,-1),Xe=s("br",null,null,-1);function Ze(n,t,o,l,e,a){return r(),c("div",xe,[S(s("div",Te,[Le,s("span",{class:"material-icons",style:{float:"right"},onClick:t[0]||(t[0]=i=>a.hide())},"clear"),Ne],512),[[L,!e.hidetip]]),s("div",{class:g({setting:!0,settingshow:e.show})},[s("span",{class:g({"material-icons":!0}),onClick:t[1]||(t[1]=i=>e.show=!e.show),id:"settingbutton"}," settings "),s("span",$e,h(e.i18n.setting[e.lang]),1),s("div",{class:"clear",onClick:t[2]||(t[2]=i=>a.clearSetting())},[Ce,s("span",ze,h(e.i18n.clear[e.lang]),1)]),je,S(s("div",Ie,[Ue,S(s("select",{"onUpdate:modelValue":t[3]||(t[3]=i=>e.targetLang=i)},[(r(!0),c(f,null,b(e.langList,i=>(r(),c("option",{key:i},h(i),1))),128))],512),[[J,e.targetLang]]),Ae,s("span",Me,h(e.i18n.dr[e.lang])+": ",1),S(s("input",{class:"textbox","onUpdate:modelValue":t[4]||(t[4]=i=>e.doctor=i),style:{float:"left"}},null,512),[[U,e.doctor]]),Oe,s("span",Re,h(e.i18n.showDelay[e.lang])+": ",1),S(s("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=i=>e.showDelay=i),"true-value":"y","false-value":"n",style:{float:"left"}},null,512),[[A,e.showDelay]]),Ee,s("span",Je,h(e.i18n.hideName[e.lang])+"(beta): ",1),S(s("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=i=>e.hideName=i),"true-value":"y","false-value":"n",style:{float:"left"}},null,512),[[A,e.hideName]]),De,s("div",{class:"save",onClick:t[7]||(t[7]=i=>a.save())},[s("span",Pe,h(e.i18n.save[e.lang]),1),Fe,Be]),Ke,s("div",He,[Ve,We,x(" "+h(a.getJSONFile()),1),qe,Ge,Ye,x(" "+h(a.getUserAgent()),1),Qe,x(" Browser width: "+h(a.getWidth()),1),Xe])],512),[[L,e.show]])],2)])}var et=p(we,[["render",Ze]]);const tt={data(){return{line:this.inputline,hideName:!1}},mounted(){this.hideName=this.isHideName()},props:{inputline:Object,story:Object,lidx:Number},methods:{parseContent(n){return _.parseContent(n)},isHideName(){if(this.lidx=="0"||_.hideName=="n"||!this.line)return!1;var n=this.story[this.lidx-1];return!!(n.prop=="name"&&n.attributes&&this.line.attributes&&(console.log(n),n.attributes.name==this.line.attributes.name))}}},nt={class:"textblock"},st=["innerHTML"];function ot(n,t,o,l,e,a){return r(),c("div",nt,[s("div",{class:g({nameblock:!0,hideName:e.hideName})},h(e.line.attributes.name),3),s("div",{class:"contentblock",innerHTML:a.parseContent(e.line.attributes.content)},null,8,st)])}var rt=p(tt,[["render",ot]]);const it={data(){return{line:this.inputline}},props:{inputline:Object},methods:{parseContent(n){return _.parseContent(n)}}},lt=["innerHTML"];function at(n,t,o,l,e,a){return r(),c("div",{class:g(e.line.prop),style:M({"text-align":e.line.attributes.alignment}),innerHTML:a.parseContent(e.line.attributes.text)},null,14,lt)}var ct=p(it,[["render",at]]);const ut={data(){return{line:this.inputline}},props:{inputline:Object},methods:{parseContent(n){return _.parseContent(n)},jumpTo(n){var t=document.getElementById(n);t.scrollIntoView({behavior:"smooth",block:"center"})},addClass(n,t){var o=document.getElementById(n);o.classList.add(t)},removeClass(n,t){var o=document.getElementById(n);o.classList.remove(t)}}},_t=["onClick","onMouseover","onMouseout","innerHTML"];function dt(n,t,o,l,e,a){return r(),c("div",{class:g(e.line.prop)},[(r(!0),c(f,null,b(e.line.attributes.values.split(";"),(i,u)=>(r(),c("div",{key:i,class:"option",onClick:d=>a.jumpTo(e.line.targetLine["option"+i]),onMouseover:d=>a.addClass(e.line.targetLine["option"+i],"PredicateFocused"),onMouseout:d=>a.removeClass(e.line.targetLine["option"+i],"PredicateFocused"),innerHTML:a.parseContent(e.line.attributes.options.split(";")[u])},null,40,_t))),128))],2)}var ht=p(ut,[["render",dt]]);const mt={data(){return{line:this.inputline}},props:{inputline:Object}},vt={key:0,class:"optText"};function pt(n,t,o,l,e,a){return r(),c("div",{class:g(e.line.prop)},[e.line.endOfOpt?N("",!0):(r(),c("div",vt,"Options: "+h(e.line.attributes.references.replaceAll(";"," ")),1))],2)}var yt=p(mt,[["render",pt]]);const gt={data(){return{line:this.inputline}},props:{inputline:Object}};function ft(n,t,o,l,e,a){return r(),c("div",{class:g(e.line.prop),style:M({height:e.line.attributes.time*30+"px"})},null,6)}var St=p(gt,[["render",ft]]);const bt={data(){return{line:this.inputline}},props:{inputline:Object}},kt=["src"];function wt(n,t,o,l,e,a){return r(),c("img",{class:"Image",src:"https://aceship.github.io/AN-EN-Tags/img/avg/images/"+e.line.attributes.image+".png"},null,8,kt)}var xt=p(bt,[["render",wt]]);const Tt={data(){return{data:_.storyData,path:_.storyFile,lang:_.l,server:_.server,doctor:_.doctor,i18n:j,showDelay:_.showDelay}},created(){this.path?C.getJSON("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+this.server+"/gamedata/story/"+this.path+".json").done(n=>this.data=n).fail(n=>{this.data={eventName:"Error on loading json file: "+this.path+"! If this is a new story, please contact the developer in github issue or discord to update the database."}}):this.data={eventName:"< - "+j.selectStory[this.lang]}},updated(){if(_.urlParams.get("warp")){var n=document.getElementById(_.urlParams.get("warp"));n&&(n.scrollIntoView({behavior:"smooth",block:"center"}),n.style.setProperty("background-color","#f4433633"))}_.focus()},methods:{jumpTo(n){var t=document.getElementById(n);t.scrollIntoView({behavior:"smooth",block:"center"})},changeColor(n,t){var o=document.getElementById(n);setInterval(o.style.setProperty("background-color",t),500)},getURL(n,t,o){return"?s="+n+"&f="+t+"&warp=line"+o},parseContent(n){return _.parseContent(n)}},components:{Nameline:rt,Subtitle:ct,Decision:ht,Predicate:yt,Delay:St,Showimg:xt}},Lt={id:"content"},Nt={class:"storydata",id:"storydata"},$t=["id"],Ct=["href"],zt=s("div",{style:{clear:"both"}},null,-1);function jt(n,t,o,l,e,a){const i=m("Nameline"),u=m("Subtitle"),d=m("Decision"),y=m("Predicate"),w=m("Delay"),T=m("Showimg");return r(),c("div",Lt,[s("div",Nt,h(e.data.eventName)+" "+h(e.data.storyCode)+" "+h(e.data.avgTag)+" "+h(e.data.storyName),1),(r(!0),c(f,null,b(e.data.storyList,(v,z)=>(r(),c("div",{key:v.id,class:"line",id:"line"+v.id},[s("a",{href:a.getURL(e.server,e.path,v.id),class:"linkButton material-icons"},"link",8,Ct),v.prop=="name"?(r(),k(i,{key:0,inputline:v,lidx:z,story:e.data.storyList},null,8,["inputline","lidx","story"])):N("",!0),v.prop=="Subtitle"?(r(),k(u,{key:1,inputline:v},null,8,["inputline"])):N("",!0),v.prop=="Decision"?(r(),k(d,{key:2,inputline:v},null,8,["inputline"])):N("",!0),v.prop=="Predicate"?(r(),k(y,{key:3,inputline:v},null,8,["inputline"])):N("",!0),v.prop=="Delay"&&e.showDelay=="y"?(r(),k(w,{key:4,inputline:v},null,8,["inputline"])):N("",!0),v.prop=="Image"&&v.attributes.image?(r(),k(T,{key:5,inputline:v},null,8,["inputline"])):N("",!0),zt],8,$t))),128))])}var It=p(Tt,[["render",jt]]);const Ut={methods:{scrollToTop(){document.getElementById("storydata").scrollIntoView({behavior:"smooth",block:"center"})}}};function At(n,t,o,l,e,a){return r(),c("span",{class:"material-icons topButton",onClick:t[0]||(t[0]=i=>a.scrollToTop())},"vertical_align_top")}var Mt=p(Ut,[["render",At]]);const Ot={props:{item:Object,iidx:Number,focus:Boolean},emits:["focusme"]},Rt={key:1,class:"material-icons itemicon lt"},Et={class:"itemname st"};function Jt(n,t,o,l,e,a){return r(),c("div",{class:g({navitem:!0,itemfocused:o.focus}),onClick:t[0]||(t[0]=i=>{n.$emit("focusme")})},[o.item.icon!="search"?(r(),c("div",{key:0,class:g([o.item.icon,"itemicon","lt"])},null,2)):N("",!0),o.item.icon=="search"?(r(),c("span",Rt,"search")):N("",!0),s("span",Et,h(o.item.title),1)],2)}var Dt=p(Ot,[["render",Jt]]);const Pt={data(){return{navi:{maintheme:{icon:"terminal-maintheme",title:"Maintheme"},intermezzi:{icon:"terminal-intermezzi",title:"Intermezzi"},sidestory:{icon:"terminal-sidestory",title:"Sidestory"},storyset:{icon:"terminal-storyset",title:"Storyset"},or:{icon:"terminal-record",title:"Records"},search:{icon:"search",title:"Search (Beta)"}}}},emits:["focuson"],props:{focus:Number},components:{Navitem:Dt}},Ft={class:"navibar"};function Bt(n,t,o,l,e,a){const i=m("Navitem");return r(),c("div",Ft,[(r(!0),c(f,null,b(e.navi,(u,d,y)=>(r(),k(i,{key:d,item:u,onFocusme:w=>{o.focus=y,n.$emit("focuson",y)},focus:o.focus==y},null,8,["item","onFocusme","focus"]))),128))])}var Kt=p(Pt,[["render",Bt]]);const Ht={data(){return{server:_.server}},emits:["focusme"],props:{eventData:Object,showStory:Boolean},methods:{getAvatar(){return"https://aceship.github.io/AN-EN-Tags/img/avatars/char_"+this.eventData.cid+"_"+this.eventData.cin+".png"},loadStory(n){var t="s="+this.server;t=t+"&f="+n,window.location.search=t}}},Vt=["src"],Wt={class:"operatorname"},qt={class:"setnumber"},Gt={class:"orstories"},Yt=["onClick"];function Qt(n,t,o,l,e,a){return r(),c("div",{class:g({oritem:!0,orfocused:o.showStory,lt:!0})},[s("div",{class:"orcard",onClick:t[0]||(t[0]=i=>n.$emit("focusme"))},[s("img",{src:a.getAvatar()},null,8,Vt),s("div",Wt,h(o.eventData.name),1),s("div",qt,"#"+h(o.eventData.set),1)]),S(s("div",Gt,[(r(!0),c(f,null,b(o.eventData.infoUnlockDatas,(i,u)=>(r(),c("div",{class:"orstory",key:u,onClick:d=>a.loadStory(i.storyTxt)},h(u)+". "+h(i.storyName),9,Yt))),128))],512),[[L,o.showStory]])],2)}var Xt=p(Ht,[["render",Qt]]);const Zt={data(){return{focus:-1}},props:{eventList:Array},components:{Oritem:Xt},methods:{focuson(n){this.focus==n?this.focus=-1:this.focus=n}}},en={class:"record"};function tn(n,t,o,l,e,a){const i=m("Oritem");return r(),c("div",en,[(r(!0),c(f,null,b(o.eventList,(u,d)=>(r(),k(i,{key:d,eventData:u,"show-story":e.focus==d,onFocusme:y=>a.focuson(d)},null,8,["eventData","show-story","onFocusme"]))),128))])}var nn=p(Zt,[["render",tn]]);const sn={props:["story"],emits:["hidemenu","focusstory","unfoldevent"],data(){return{focused:!1,lang:_.l,server:_.server}},mounted(){_.storyFile==this.story.storyTxt&&(this.focused=!0,this.$emit("unfoldevent"))},methods:{loadStory(n,t){var o="s="+this.server;o=o+"&f="+t,window.location.search=o}}},on=["id"],rn={class:"storycode xst"},ln={class:"storyname nt"};function an(n,t,o,l,e,a){return r(),c("div",{class:g({story:!0,storyFocused:e.focused}),id:o.story.storyId,onClick:t[0]||(t[0]=i=>a.loadStory(e.lang,o.story.storyTxt))},[s("div",rn,h(o.story.storyCode)+" "+h(o.story.avgTag),1),s("div",ln,h(o.story.storyName),1)],10,on)}var cn=p(sn,[["render",an]]);const un={props:["event","eventid"],emits:["hidemenu","focusStory"],data(){return{collapsed:!0}},components:{Storymenu:cn}},_n={class:"event"},dn={class:"stories"};function hn(n,t,o,l,e,a){const i=m("Storymenu");return r(),c("div",_n,[s("div",{class:g({eventname:!0,eventnamehl:!e.collapsed,lt:!0}),onClick:t[0]||(t[0]=u=>e.collapsed=!e.collapsed)},h(o.event.name),3),S(s("div",dn,[(r(!0),c(f,null,b(o.event.infoUnlockDatas,(u,d)=>(r(),k(i,{story:u,onUnfoldevent:t[1]||(t[1]=y=>{e.collapsed=!1,n.$emit("focusStory")}),key:d},null,8,["story"]))),128))],512),[[L,!e.collapsed]])])}var I=p(un,[["render",hn]]);const mn={props:{eventList:Object},components:{Eventmenu:I}},vn={class:"maintheme"};function pn(n,t,o,l,e,a){const i=m("Eventmenu");return r(),c("div",vn,[(r(!0),c(f,null,b(o.eventList,(u,d)=>(r(),k(i,{key:d,event:u,eventid:u.id},null,8,["event","eventid"]))),128))])}var yn=p(mn,[["render",pn]]);const gn={props:{eventList:Object},components:{Eventmenu:I}},fn={class:"intermezzi"};function Sn(n,t,o,l,e,a){const i=m("Eventmenu");return r(),c("div",fn,[(r(!0),c(f,null,b(o.eventList,(u,d)=>(r(),k(i,{key:d,event:u,eventid:u.id},null,8,["event","eventid"]))),128))])}var bn=p(gn,[["render",Sn]]);const kn={props:{eventList:Object},components:{Eventmenu:I}},wn={class:"sidestory"};function xn(n,t,o,l,e,a){const i=m("Eventmenu");return r(),c("div",wn,[(r(!0),c(f,null,b(o.eventList,(u,d)=>(r(),k(i,{key:d,event:u,eventid:u.id},null,8,["event","eventid"]))),128))])}var Tn=p(kn,[["render",xn]]);const Ln={props:{eventList:Object},components:{Eventmenu:I}},Nn={class:"storyset"};function $n(n,t,o,l,e,a){const i=m("Eventmenu");return r(),c("div",Nn,[(r(!0),c(f,null,b(o.eventList,(u,d)=>(r(),k(i,{key:d,event:u,eventid:u.id},null,8,["event","eventid"]))),128))])}var Cn=p(Ln,[["render",$n]]);const zn={data(){return{searchvalue:"",result:{},server:_.server,resultNumber:0,isIncomplete:!1,isSearching:!1}},props:{eventList:Object},methods:{searchRequest(){this.isSearching=!0,this.result={},this.resultNumber="Searching";var n="https://api.github.com/search/code?q="+this.searchvalue+"+repo:050644zf/ArknightsStoryJson+path:"+this.server+"/gamedata";C.ajaxSetup({headers:{Accept:"application/vnd.github.v3.text-match+json"}}),C.getJSON(n).done(t=>{this.result={};const o=/.+\/gamedata\/story\/(.+)\./;this.resultNumber=t.total_count,this.isIncomplete=t.incomplete_results;var l=[],e=[],a;for(a in t.items)console.log(t.items[a].path.match(o)[1]),e.push(t.items[a].path.match(o)[1]),l.push(t.items[a].text_matches);console.log(l);var i,u,d;for(i in this.eventList){var y=this.eventList[i];for(u in y){var w=y[u],T=[];for(d in w.infoUnlockDatas){var v=e.indexOf(w.infoUnlockDatas[d].storyTxt);v>-1&&(console.log(v),e.splice(v,1),T.push({storyCode:w.infoUnlockDatas[d].storyCode,avgTag:w.infoUnlockDatas[d].avgTag,storyName:w.infoUnlockDatas[d].storyName,storyPath:w.infoUnlockDatas[d].storyTxt,text_matches:l[v]}),l.splice(v,1))}T.length&&(this.result[w.name]=T)}}}),this.isSearching=!1},parseFrag(n,t){if(n){var o;for(o in t)n=n.replaceAll(t[o].text,'<span style="color:yellow">'+t[o].text+"</span>");n=n.replaceAll("\\n","<br/>")}return n},loadStory(n){var t="s="+this.server;t=t+"&f="+n,window.location.search=t}}},jn={class:"search"},In=s("br",null,null,-1),Un={style:{display:"flex","align-items":"center","justify-content":"space-between"}},An={class:"resulttitle"},Mn={style:{"font-size":"smaller"}},On=s("br",null,null,-1),Rn=["onClick"],En=["innerHTML"],Jn=s("div",{class:"st",style:{margin:"10%",color:"rgba(255,255,255,0.7)"}},[s("p",{style:{"text-align":"center"}},"The search feature is powered by Github API."),s("p",{style:{"font-weight":"bold"}},"Didn't find the expected result?"),s("p",null,[x("The Github code search only return the result that the target text is exactly surrounded by "),s("span",{style:{"font-weight":"bold"}},"spaces or punctuation"),x(". Try using plural noun or change its tense to get more results. ")])],-1);function Dn(n,t,o,l,e,a){return r(),c("div",jn,[s("div",{class:g({searchbar:!0,searching:e.isSearching,nt:!0})},[S(s("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>e.searchvalue=i),onKeyup:t[1]||(t[1]=D(i=>a.searchRequest(),["enter"]))},null,544),[[U,e.searchvalue]]),s("span",{class:"material-icons",onClick:t[2]||(t[2]=i=>a.searchRequest())},"search")],2),s("div",{class:g({searchresult:!0,searching:e.isSearching})},[x(h(e.resultNumber)+" results",1),In,(r(!0),c(f,null,b(e.result,(i,u,d)=>(r(),c("div",{key:d,style:{"font-weight":"bold",margin:"5px"}},[x(h(u)+" ",1),(r(!0),c(f,null,b(i,(y,w)=>(r(),c("div",{key:w,style:{"font-weight":"normal","margin-left":"20px"}},[s("div",Un,[s("div",An,[s("span",Mn,h(y.storyCode)+" "+h(y.avgTag),1),On,s("span",null,h(y.storyName),1)]),s("span",{class:"material-icons loadButton",onClick:T=>a.loadStory(y.storyPath)},"open_in_new",8,Rn)]),(r(!0),c(f,null,b(y.text_matches,(T,v)=>(r(),c("div",{class:"textmatch",key:v,innerHTML:a.parseFrag(T.fragment,T.matches)},null,8,En))),128))]))),128))]))),128))],2),Jn])}var Pn=p(zn,[["render",Dn]]);const Fn={data(){return{focus:0,i18n:j,lang:_.l,server:_.server,chardict:{},intermezzi:_.intermezzi,eventList:{},data:{},showLangSelect:!1}},created(){C.getJSON("https://raw.githubusercontent.com/Kengxxiao/ArknightsGameData/master/"+this.server+"/gamedata/excel/story_review_table.json").done(n=>{this.data=n,C.getJSON("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+this.server+"/chardict.json").done(t=>{this.chardict=t,this.eventList=this.getEventList(this.data,this.chardict)})})},components:{Navibar:Kt,Maintheme:yn,Intermezzi:bn,Sidestory:Tn,Storyset:Cn,Or:nn,Search:Pn},methods:{serverSwitch(n){var t="s="+n;window.location.search=t},getEventList(n,t){var o={maintheme:[],intermezzi:[],sidestory:[],storyset:[],or:[]},l;for(l in n)if(n[l].entryType=="MAINLINE")o.maintheme.push(n[l]);else if(n[l].entryType=="ACTIVITY")this.intermezzi.indexOf(l)==-1?o.sidestory.push(n[l]):o.intermezzi.push(n[l]);else if(n[l].entryType=="MINI_ACTIVITY")o.storyset.push(n[l]);else if(n[l].entryType=="NONE"){var e=l.split("_")[1],a=l.split("_")[3];n[l].name=t[e].name,n[l].cid=t[e].id,n[l].cin=e,n[l].set=a,o.or.push(n[l])}return o.intermezzi.sort(function(i,u){return i.startTime-u.startTime}),o.sidestory.sort(function(i,u){return i.startTime-u.startTime}),o.storyset.sort(function(i,u){return i.startTime-u.startTime}),o}}},Bn={class:"menupage"},Kn={id:"currentLang lt",class:"currentLang"},Hn=s("span",{class:"material-icons lt",style:{"margin-right":"5px"}},"language",-1),Vn={class:"lt"},Wn={id:"langSelect",class:"langSelect lt"},qn=["onClick"],Gn=s("br",null,null,-1);function Yn(n,t,o,l,e,a){const i=m("Navibar"),u=m("Maintheme"),d=m("Intermezzi"),y=m("Sidestory"),w=m("Storyset"),T=m("Or"),v=m("Search");return r(),c("div",Bn,[s("div",Kn,[s("div",{style:{display:"flex","align-items":"center","justify-content":"center"},onClick:t[0]||(t[0]=z=>e.showLangSelect=!e.showLangSelect)},[Hn,s("span",Vn,h(e.i18n.server[e.server]),1)]),S(s("div",Wn,[(r(!0),c(f,null,b(e.i18n.server,(z,O,R)=>(r(),c("div",{onClick:_s=>a.serverSwitch(O),key:R},h(z),9,qn))),128))],512),[[L,e.showLangSelect]])]),Gn,$(i,{focus:e.focus,onFocuson:t[1]||(t[1]=z=>e.focus=z)},null,8,["focus"]),S($(u,{eventList:e.eventList.maintheme},null,8,["eventList"]),[[L,e.focus==0]]),S($(d,{eventList:e.eventList.intermezzi},null,8,["eventList"]),[[L,e.focus==1]]),S($(y,{eventList:e.eventList.sidestory},null,8,["eventList"]),[[L,e.focus==2]]),S($(w,{eventList:e.eventList.storyset},null,8,["eventList"]),[[L,e.focus==3]]),S($(T,{eventList:e.eventList.or},null,8,["eventList"]),[[L,e.focus==4]]),S($(v,{eventList:e.eventList},null,8,["eventList"]),[[L,e.focus==5]])])}var Qn=p(Fn,[["render",Yn]]);const Xn={data(){return{storyData:{},storyFile:_.storyFile,lang:_.l,server:_.server,latestUpdate:0}},created(){C.getJSON("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/log.json").done(n=>{console.log(n),this.latestUpdate=n.latestCommitTime})},components:{Header:E,Menu:ke,Content:It,Settings:et,Topbtn:Mt,Menupage:Qn},methods:{dateFormatter(n){var t=new Date(n*1e3),o="";return o=t.getUTCFullYear()+"-"+(t.getUTCMonth()+1)+"-"+t.getUTCDate()+" "+t.getUTCHours()+":"+t.getUTCMinutes()+":"+t.getUTCSeconds(),o}}},Zn={class:"info st"},es=s("hr",null,null,-1),ts=s("br",null,null,-1),ns=x(" Auto Updater scheduled at 08:30 UTC everyday. "),ss=s("br",null,null,-1),os=s("br",null,null,-1),rs=x(" Current Status: "),is=s("br",null,null,-1),ls=s("img",{src:"https://app.travis-ci.com/050644zf/ArknightsStoryTextReader.svg?branch=master"},null,-1),as=s("img",{src:"https://github.com/050644zf/ArknightsStoryTextReader/actions/workflows/ASTRAutoUpdater.yml/badge.svg"},null,-1);function cs(n,t,o,l,e,a){const i=m("Header"),u=m("Menu"),d=m("Settings"),y=m("Menupage"),w=m("Content"),T=m("Topbtn");return r(),c(f,null,[$(i),e.storyFile?(r(),k(u,{key:0})):N("",!0),$(d),e.storyFile?N("",!0):(r(),k(y,{key:1})),e.storyFile?(r(),k(w,{key:2})):N("",!0),$(T),s("div",Zn,[es,x(" Last Update (UTC): "+h(a.dateFormatter(e.latestUpdate)),1),ts,ns,ss,os,rs,is,ls,as])],64)}var us=p(Xn,[["render",cs]]);P(us).mount("#ASTR");console.log(_.urlParams.get("f"));
