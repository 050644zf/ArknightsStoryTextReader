import{_ as T}from"./plugin-vue_export-helper.ad25fb64.js";import{S as te,P as ye,D as we,V as Se,p as be,q as xe,r as s,o as u,c as x,l as e,s as t,a as v,t as m,h as i,F as A,b as j,d as g,L as Ie,A as ne,G as ke,u as Te,y as Ne,z as oe,B as se,T as ze,C as Le,E as re,j as E,H as ie,O as Ce,$ as ae,I as Ae,n as M,M as H,J as Oe,w as B,v as q,i as le,K as $e,N as De,x as F,Q as je,R as Re,U as Ue,W as Ee,m as Je,X as Pe}from"./vendor.61975e9a.js";const Me={zh_CN:"\u7B80\u4E2D\u670D(CN)",en_US:"Global Server(EN)",ja_JP:"\u65E5\u672C\u30B5\u30FC\u30D0\u30FC(JP)",ko_KR:"\uD55C\uAD6D \uC11C\uBC84(KR)",zh_TW:"\u7E41\u4E2D\u670D(TW)"},Fe={zh_CN:"\u5F53\u524D\u8BED\u8A00",en_US:"Current Language",ja_JP:"\u73FE\u5728\u306E\u8A00\u8A9E",ko_KR:"\uD604\uC7AC \uC5B8\uC5B4",zh_TW:"\u7576\u524D\u8A9E\u8A00"},Ke={zh_CN:"\u8BF7\u4ECE\u76EE\u5F55\u4E2D\u9009\u62E9\u6545\u4E8B\u67E5\u770B",en_US:"Select the story you wanna view from the menu",ja_JP:"Select the story you wanna view from the menu",ko_KR:"Select the story you wanna view from the menu",zh_TW:"\u8ACB\u5F9E\u76EE\u9304\u4E2D\u9078\u64C7\u6545\u4E8B\u67E5\u770B"},We={zh_CN:"\u9996\u9875",en_US:"Homepage",ja_JP:"\u30DB\u30FC\u30E0\u30DA\u30FC\u30B8",ko_KR:"\uD648\uD398\uC774\uC9C0",zh_TW:"\u9996\u9801"},He={zh_CN:"\u4E3B\u9898\u66F2",en_US:"Maintheme",ja_JP:"Maintheme",ko_KR:"Maintheme",zh_TW:"\u4E3B\u9898\u66F2"},Be={zh_CN:"\u63D2\u66F2",en_US:"Intermezzi",ja_JP:"Intermezzi",ko_KR:"Intermezzi",zh_TW:"\u63D2\u66F2"},qe={zh_CN:"\u522B\u4F20",en_US:"Sidestory",ja_JP:"Sidestory",ko_KR:"Sidestory",zh_TW:"\u522B\u4F20"},Ge={zh_CN:"\u6545\u4E8B\u96C6",en_US:"Storyset",ja_JP:"Storyset",ko_KR:"Storyset",zh_TW:"\u6545\u4E8B\u96C6"},Ve={zh_CN:"\u5E72\u5458\u5BC6\u5F55",en_US:"Operators' Records",ja_JP:"Operators' Records",ko_KR:"Operators' Records",zh_TW:"\u5E79\u54E1\u5BC6\u9304"},Ye={zh_CN:"\u641C\u7D22",en_US:"Search",ja_JP:"\u691C\u7D22",ko_KR:"Search",zh_TW:"\u641C\u7D22"},Ze={zh_CN:"\u8BBE\u7F6E",en_US:"Settings",ja_JP:"Settings",ko_KR:"Settings",zh_TW:"\u8BBE\u7F6E"},Xe={zh_CN:"\u91CD\u7F6E\u6240\u6709\u8BBE\u7F6E",en_US:"Reset All Settings",ja_JP:"Reset All Settings",ko_KR:"Reset All Settings",zh_TW:"\u91CD\u7F6E\u6240\u6709\u8BBE\u7F6E"},Qe={zh_CN:"\u535A\u58EB\u79F0\u547C",en_US:"Doctor's Name",ja_JP:"\u30C9\u30AF\u30BF\u30FC\u306E\u540D\u524D",ko_KR:"Doctor's Name",zh_TW:"\u535A\u58EB\u7A31\u547C"},et={zh_CN:"\u663E\u793A\u7A7A\u767D\u5206\u5272\u884C",en_US:"Show Blank Seperation Line",ja_JP:"Show Blank Seperation Line",ko_KR:"Show Blank Seperation Line",zh_TW:"\u986F\u793A\u7A7A\u767D\u5206\u5272\u884C"},tt={zh_CN:"\u9690\u85CF\u91CD\u590D\u4EBA\u540D",en_US:"Hide Duplicate Names",ja_JP:"Hide Duplicate Names",ko_KR:"Hide Duplicate Names",zh_TW:"\u96B1\u85CF\u91CD\u8907\u4EBA\u540D"},nt={zh_CN:"\u5E94\u7528\u8BBE\u7F6E",en_US:"Apply Setting",ja_JP:"Apply Setting",ko_KR:"Apply Setting",zh_TW:"\u5E94\u7528\u8BBE\u7F6E"},ot={zh_CN:"\u8FD4\u56DE\u76EE\u5F55",en_US:"Return to Menu",ja_JP:"Return to Menu",ko_KR:"Return to Menu",zh_TW:"\u8FD4\u56DE\u76EE\u9304"},st={zh_CN:"\u76EE\u5F55",en_US:"Menu",ja_JP:"Menu",ko_KR:"Menu",zh_TW:"\u76EE\u9304"},rt={zh_CN:"\u5BFC\u51FAExcel",en_US:"Export to Excel",ja_JP:"Export to Excel",ko_KR:"Export to Excel",zh_TW:"\u5C0E\u51FAExcel"},it={zh_CN:"\u663E\u793A\u7B80\u4ECB",en_US:"Show Intro",ja_JP:"Show Intro",ko_KR:"Show Intro",zh_TW:"\u986F\u793A\u7C21\u4ECB"},at={zh_CN:"\u7531\u4E8E\u6280\u672F\u95EE\u9898\uFF0C\u9009\u9879\u8DDF\u8E2A\u5728\u8BE5\u6545\u4E8B\u5DF2\u88AB\u7981\u7528",en_US:"Option Tracing Feature is disabled in this story due to technical issues.",ja_JP:"Option Tracing Feature is disabled in this story due to technical issues.",ko_KR:"Option Tracing Feature is disabled in this story due to technical issues.",zh_TW:"\u7531\u65BC\u6280\u8853\u554F\u984C\uFF0C\u9078\u9805\u8DDF\u8E2A\u5728\u8A72\u6545\u4E8B\u5DF2\u88AB\u7981\u7528"};var J={server:Me,currentLang:Fe,selectStory:Ke,homepage:We,main:He,intermezzi:Be,ss:qe,mini:Ge,or:Ve,search:Ye,setting:Ze,clear:Xe,dr:Qe,showDelay:et,hideName:tt,save:nt,home:ot,menu:st,export2excel:rt,showIntro:it,optionTraceDisabled:at};const ce=["zh_CN","en_US","ko_KR","ja_JP","zh_TW"];var G=new URLSearchParams(window.location.search),V=G.get("s"),U=window.localStorage.getItem("lang"),Y=window.localStorage.getItem("doctor"),Z=window.localStorage.getItem("hidetip"),X=window.localStorage.getItem("showDelay"),Q=window.localStorage.getItem("hideName"),K=window.localStorage.getItem("wversion"),lt=G.get("f"),ct={eventName:"Loading..."},_e=!1;const ue=13;V||(V="zh_CN");(!U||U=="none"||U=="Default")&&(U=navigator.language.replace("-","_"));U=="ja"&&(U="ja_JP");ce.indexOf(U)==-1&&(U="en_US");console.log("Current Language: "+U);Y||(Y="{@nickname}");Z||(Z=!1);X||(X="y");Q||(Q="n");(!K||K<ue)&&(K=ue,window.localStorage.setItem("wversion",K),_e=!0);var C={urlParams:G,l:U,langList:ce,server:V,doctor:Y,hidetip:Z,showDelay:X,hideName:Q,storyFile:lt,storyData:ct,intermezzi:["act9d0","act18d0","act18d3"],wversion:K,isOldversion:_e,parseContent(n){if(n){const r=/<color=([\w#]+)>(.+?)<\/color>/gm,c='<span style="color:$1">$2</span>';n=n.replaceAll("{@nickname}",this.doctor),n=n.replaceAll("\\n","<br/>"),n=n.replace(r,c)}return n},focus(){var n=document.getElementsByClassName("storyFocused")[0];n&&n.scrollIntoView({behavior:"smooth",block:"center"}),console.log("focused!")}};const _t={data(){return{i18n:J,currentLang:C.l,langOpts:C.langList,doctor:C.doctor,showDelay:C.showDelay,hideName:C.hideName}},props:{showsettings:{type:Boolean,default:!1}},components:{SettingsIcon:te,LangIcon:ye,DrNameIcon:we,BlankIcon:Se,SaveIcon:be,ResetIcon:xe},methods:{save(){window.localStorage.setItem("doctor",this.doctor),window.localStorage.setItem("showDelay",this.showDelay),window.localStorage.setItem("hideName",this.hideName),window.localStorage.setItem("lang",this.currentLang),window.location.reload(!0)},clearSetting(){window.localStorage.clear(),window.location.reload(!0)}}},ut=i(" Dr. ");function pt(n,r,c,a,o,l){const p=s("SettingsIcon"),d=s("n-icon"),_=s("n-button"),h=s("n-space"),f=s("LangIcon"),w=s("n-radio-button"),y=s("n-radio-group"),S=s("DrNameIcon"),b=s("n-input"),N=s("BlankIcon"),z=s("n-switch"),O=s("ResetIcon"),L=s("SaveIcon"),D=s("n-drawer-content"),R=s("n-drawer");return u(),x(A,null,[e(_,{text:"",class:"SettingsBtn",onClick:r[0]||(r[0]=I=>c.showsettings=!0)},{default:t(()=>[e(d,{size:"24"},{default:t(()=>[e(p)]),_:1})]),_:1}),e(R,{show:c.showsettings,"onUpdate:show":r[6]||(r[6]=I=>c.showsettings=I),placement:"top"},{default:t(()=>[e(D,{closable:""},{header:t(()=>[e(h,{"item-style":"display:flex;",align:"center"},{default:t(()=>[e(d,null,{default:t(()=>[e(p)]),_:1}),v("span",null,m(o.i18n.setting[o.currentLang]),1)]),_:1})]),footer:t(()=>[e(h,{"item-style":"display:flex;",align:"center",justify:"end"},{default:t(()=>[e(_,{strong:"",secondary:"",type:"error",onClick:r[4]||(r[4]=I=>l.clearSetting())},{icon:t(()=>[e(d,null,{default:t(()=>[e(O)]),_:1})]),default:t(()=>[i(" "+m(o.i18n.clear[o.currentLang]),1)]),_:1}),e(_,{strong:"",type:"primary",onClick:r[5]||(r[5]=I=>l.save())},{icon:t(()=>[e(d,null,{default:t(()=>[e(L)]),_:1})]),default:t(()=>[i(" "+m(o.i18n.save[o.currentLang]),1)]),_:1})]),_:1})]),default:t(()=>[e(h,{"item-style":"display:flex;",align:"center"},{default:t(()=>[e(d,null,{default:t(()=>[e(f)]),_:1}),i(" "+m(o.i18n.currentLang[o.currentLang])+": ",1),e(y,{value:o.currentLang,"onUpdate:value":r[1]||(r[1]=I=>o.currentLang=I)},{default:t(()=>[(u(!0),x(A,null,j(o.langOpts,I=>(u(),g(w,{key:I,value:I},{default:t(()=>[i(m(I),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),e(h,{"item-style":"display:flex;",align:"center"},{default:t(()=>[e(d,null,{default:t(()=>[e(S)]),_:1}),i(" "+m(o.i18n.dr[o.currentLang])+": ",1),e(h,{"item-style":"display:flex;",align:"center",justify:"end"},{default:t(()=>[ut,e(b,{value:o.doctor,"onUpdate:value":r[2]||(r[2]=I=>o.doctor=I),type:"text",placeholder:"{@nickname}"},null,8,["value"])]),_:1})]),_:1}),e(h,{"item-style":"display:flex;",align:"center"},{default:t(()=>[e(d,null,{default:t(()=>[e(N)]),_:1}),i(" "+m(o.i18n.showDelay[o.currentLang])+": ",1),e(z,{value:o.showDelay,"onUpdate:value":r[3]||(r[3]=I=>o.showDelay=I),"checked-value":"y","unchecked-value":"n"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["show"])],64)}var dt=T(_t,[["render",pt]]);const ht={data(){return{serverOpts:this.getServerOpts(),i18n:J,showsettings:!1,server:this.$route.params.server}},created(){this.$watch(()=>this.$route.params,(n,r)=>{r.server!=n.server&&(this.serverOpts=this.getServerOpts())})},components:{LangIcon:Ie,ArrowDropDown:ne,SettingsIcon:te,Settings:dt},emits:["pushServer"],methods:{getServerOpts(){var n=[];for(var r in J.server)n.push({label:J.server[r],key:r,disabled:r==this.$route.params.server});return console.log(this.$route),n},async pushServer(n){this.$emit("pushServer",{server:n})}}},mt=i(" Arknights Story Text Reader "),gt=i("web version 0.91");function ft(n,r,c,a,o,l){const p=s("n-image"),d=s("n-h2"),_=s("n-text"),h=s("n-space"),f=s("LangIcon"),w=s("n-icon"),y=s("ArrowDropDown"),S=s("n-button"),b=s("n-dropdown"),N=s("Settings"),z=s("n-layout-header");return u(),g(z,null,{default:t(()=>[e(h,{"item-style":"display: flex;",justify:"space-between",align:"center",class:"header"},{default:t(()=>[e(h,{"item-style":"display: flex;",align:"center"},{default:t(()=>[e(p,{src:"https://raw.githubusercontent.com/050644zf/ArknightsStoryTextReader/master/reader/src/assets/favicon.png",width:"40"}),e(h,{"item-style":"display: flex;",align:"baseline"},{default:t(()=>[e(d,{style:{margin:"0px",padding:"5px"},strong:""},{default:t(()=>[mt]),_:1}),e(_,{depth:"3"},{default:t(()=>[gt]),_:1})]),_:1})]),_:1}),e(h,{justify:"space-around","item-style":"display: flex;",align:"center"},{default:t(()=>[e(b,{options:o.serverOpts,onSelect:l.pushServer,class:"serverSelect"},{default:t(()=>[e(S,{text:""},{icon:t(()=>[e(w,null,{default:t(()=>[e(f)]),_:1})]),default:t(()=>[i(" "+m(o.i18n.server[n.$route.params.server])+" ",1),e(w,{size:"24"},{default:t(()=>[e(y)]),_:1})]),_:1})]),_:1},8,["options","onSelect"]),e(N)]),_:1})]),_:1})]),_:1})}var pe=T(ht,[["render",ft]]);const vt={data(){return{latestUpdate:0}},components:{Github:ke,Discord:Te},created(){fetch("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/log.json").then(n=>n.json()).then(n=>{this.latestUpdate=n.latestCommitTime})},methods:{dateFormatter(n){var r=new Date(n*1e3),c="";return c=r.getUTCFullYear()+"-"+(r.getUTCMonth()+1)+"-"+r.getUTCDate()+" "+r.getUTCHours()+":"+r.getUTCMinutes()+":"+r.getUTCSeconds(),c},load(n){window.location=n}}},yt=v("br",null,null,-1),wt=i(" \u5F53\u524D\u72B6\u6001 / Current Status: "),St=v("br",null,null,-1),bt=v("img",{src:"https://app.travis-ci.com/050644zf/ArknightsStoryTextReader.svg?branch=master"},null,-1),xt=i("\xA0 "),It=v("img",{src:"https://github.com/050644zf/ArknightsStoryTextReader/actions/workflows/ASTRAutoUpdater.yml/badge.svg"},null,-1);function kt(n,r,c,a,o,l){const p=s("Github"),d=s("n-icon"),_=s("n-button"),h=s("Discord"),f=s("n-space"),w=s("n-text"),y=s("n-layout-footer");return u(),g(y,null,{default:t(()=>[e(f,{justify:"space-around",class:"footer"},{default:t(()=>[e(f,{justify:"space-around"},{default:t(()=>[e(_,{text:"",onClick:r[0]||(r[0]=S=>l.load("https://github.com/050644zf/ArknightsStoryTextReader"))},{default:t(()=>[e(d,{size:"32"},{default:t(()=>[e(p)]),_:1})]),_:1}),e(_,{text:"",onClick:r[1]||(r[1]=S=>l.load("https://discord.gg/rihq"))},{default:t(()=>[e(d,{size:"32"},{default:t(()=>[e(h)]),_:1})]),_:1})]),_:1}),e(w,null,{default:t(()=>[i(" \u6700\u540E\u66F4\u65B0 / Last Update (UTC) : "+m(l.dateFormatter(o.latestUpdate)),1),yt,wt,St,bt,xt,It]),_:1})]),_:1})]),_:1})}var Tt=T(vt,[["render",kt]]);const Nt={data(){return{darkTheme:Ne}},components:{Header:pe,Footer:Tt}};function zt(n,r,c,a,o,l){const p=s("router-view"),d=s("n-dialog-provider"),_=s("n-loading-bar-provider"),h=s("Footer"),f=s("n-config-provider"),w=s("n-layout");return u(),g(w,null,{default:t(()=>[e(f,{theme:o.darkTheme},{default:t(()=>[e(_,null,{default:t(()=>[e(d,null,{default:t(()=>[e(p)]),_:1})]),_:1}),e(h)]),_:1},8,["theme"])]),_:1})}var Lt=T(Nt,[["render",zt]]);const Ct={data(){return{server:this.$route.params.server,intermezzi:C.intermezzi,loadingbar:oe(),dialog:se()}},created(){this.initServerData(),this.$watch(()=>this.$route.params,(n,r)=>{r.server!=n.server&&window.location.reload()})},components:{Header:pe},methods:{async pushServer({server:n}){const r=this.server;this.server=n,await this.initServerData(),window.location.href=window.location.href.replace(r,n)},async initServerData(){this.loadingbar.start();try{let n=await fetch("https://raw.githubusercontent.com/Kengxxiao/ArknightsGameData/master/"+this.server+"/gamedata/excel/story_review_table.json").then(l=>l.json()),r=await fetch("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+this.server+"/chardict.json").then(l=>l.json()),c=await fetch("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+this.server+"/storyinfo.json").then(l=>l.json()),a=await fetch("https://raw.githubusercontent.com/Kengxxiao/ArknightsGameData/master/"+this.server+"/gamedata/excel/chapter_table.json").then(l=>l.json()),o=await this.getEventList(n,r);a=await this.getMainthemeData(a,o),window.sessionStorage.setItem("server",this.server),window.sessionStorage.setItem("menudata",JSON.stringify(n)),window.sessionStorage.setItem("chardict",JSON.stringify(r)),window.sessionStorage.setItem("infodata",JSON.stringify(c)),window.sessionStorage.setItem("eventList",JSON.stringify(o)),window.sessionStorage.setItem("chapterdata",JSON.stringify(a)),this.loadingbar.finish()}catch(n){this.loadingbar.error(),console.log(n),this.dialog.error({title:"Fail to Load Event Data",content:"This maybe because of the server is not supported or the data is not available.If you are sure the server is supported, please summit a issue."})}},async getEventList(n,r){var c={maintheme:[],intermezzi:[],sidestory:[],storyset:[],or:[]},a;for(a in n)if(n[a].entryType=="MAINLINE")c.maintheme.push(n[a]);else if(n[a].entryType=="ACTIVITY")this.intermezzi.indexOf(a)==-1?c.sidestory.push(n[a]):c.intermezzi.push(n[a]);else if(n[a].entryType=="MINI_ACTIVITY")c.storyset.push(n[a]);else if(n[a].entryType=="NONE"){var o=a.split("_")[1],l=a.split("_")[3];n[a].name=r[o].name,n[a].cid=r[o].id,n[a].cin=o,n[a].set=l,c.or.push(n[a])}return c.intermezzi.sort(function(p,d){return p.startTime-d.startTime}),c.sidestory.sort(function(p,d){return p.startTime-d.startTime}),c.storyset.sort(function(p,d){return p.startTime-d.startTime}),c},async getMainthemeData(n,r){for(var c in n){var a=[],o=!1;for(var l of r.maintheme)l.id==n[c].startZoneId&&(o=!0),o&&a.push(l.id),l.id==n[c].endZoneId&&(o=!1);n[c].events=a}return n}}};function At(n,r,c,a,o,l){const p=s("Header"),d=s("router-view");return u(),x(A,null,[e(p,{onPushServer:l.pushServer},null,8,["onPushServer"]),e(d,null,{default:t(({Component:_})=>[e(ze,{name:"fade"},{default:t(()=>[(u(),g(Le(_)))]),_:2},1024)]),_:1})],64)}var Ot=T(Ct,[["render",At]]);const $t={data(){return{cdata:window.sessionStorage.getItem("chapterdata")?JSON.parse(window.sessionStorage.getItem("chapterdata")):[],mdata:window.sessionStorage.getItem("menudata")?JSON.parse(window.sessionStorage.getItem("menudata")):{}}}},Dt=["src"];function jt(n,r,c,a,o,l){const p=s("n-h3"),d=s("n-text"),_=s("n-space"),h=s("n-card"),f=s("n-step"),w=s("n-steps");return u(),g(w,{vertical:""},{"finish-icon":t(()=>[]),default:t(()=>[(u(!0),x(A,null,j(o.cdata,(y,S)=>(u(),g(f,{key:S},{title:t(()=>[e(_,null,{default:t(()=>[e(p,{strong:"",style:{margin:"0px"}},{default:t(()=>[i(m(y.chapterName),1)]),_:2},1024),e(d,{depth:"3"},{default:t(()=>[i(m(y.chapterName2),1)]),_:2},1024)]),_:2},1024)]),default:t(()=>[e(_,{vertical:""},{default:t(()=>[e(_,{"item-style":"display: flex;",align:"center"},{default:t(()=>[(u(!0),x(A,null,j(y.events,(b,N)=>(u(),g(h,{"content-style":"padding: 0px;",key:N,size:"large",class:"episode",onClick:z=>n.$router.push("/"+n.$route.params.server+"/event/"+b)},{cover:t(()=>[v("img",{src:"https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/img/icons/"+b+".png",class:"mainicon",style:{height:"100px",width:"100px",margin:"auto"}},null,8,Dt)]),default:t(()=>[e(d,{strong:""},{default:t(()=>[i(m(o.mdata[b].name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})}var Rt=T($t,[["render",jt]]);const Ut={props:["eventype"],data(){return{mdata:window.sessionStorage.getItem("menudata")?JSON.parse(window.sessionStorage.getItem("menudata")):{},eventList:window.sessionStorage.getItem("eventList")?JSON.parse(window.sessionStorage.getItem("eventList")):[]}},components:{ForwardIcon:re}},Et=["src"],Jt=["src"];function Pt(n,r,c,a,o,l){const p=s("n-h2"),d=s("n-text"),_=s("n-space"),h=s("ForwardIcon"),f=s("n-icon"),w=s("n-button"),y=s("n-list-item"),S=s("n-list");return u(),g(_,{class:"events","item-style":"display:flex;"},{default:t(()=>[e(S,{class:"list"},{default:t(()=>[(u(!0),x(A,null,j(o.eventList[c.eventype],(b,N)=>(u(),g(y,{key:N},{suffix:t(()=>[e(w,{text:"",onClick:z=>n.$router.push("/"+n.$route.params.server+"/event/"+b.id)},{default:t(()=>[e(f,{size:"32"},{default:t(()=>[e(h)]),_:1})]),_:2},1032,["onClick"])]),default:t(()=>[e(_,{"item-style":"display:flex;",align:"center"},{default:t(()=>[c.eventype!="or"?(u(),x("img",{key:0,src:"https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/img/banners/"+b.id+".png"},null,8,Et)):(u(),x("img",{key:1,src:"https://aceship.github.io/AN-EN-Tags/img/avatars/char_"+b.cid+"_"+b.cin+".png",style:{height:"64px"}},null,8,Jt)),e(_,{"item-style":"display:flex;",align:"baseline"},{default:t(()=>[e(p,{style:{padding:"0px"}},{default:t(()=>[i(m(b.name),1)]),_:2},1024),c.eventype=="or"?(u(),g(d,{key:0,depth:"3"},{default:t(()=>[i("#"+m(b.set),1)]),_:2},1024)):E("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})}var Mt=T(Ut,[["render",Pt]]);const Ft={},Kt=i(" \u6B22\u8FCE\u8BBF\u95EE\u660E\u65E5\u65B9\u821F\u5267\u60C5\u6587\u672C\u9605\u8BFB\u5668\uFF01"),Wt=v("br",null,null,-1),Ht=i(" Welcome to Arknights Story Text Reader! "),Bt=i(" \u8FD9\u662F\u65B0\u7248ASTR\u7684beta\u6D4B\u8BD5\uFF0C\u5C1A\u672A\u8FD8\u539F\u65E7\u7248ASTR\u7684\u6240\u6709\u529F\u80FD\uFF0C\u4E14\u6682\u672A\u4F18\u5316\u79FB\u52A8\u7AEF\u7F51\u9875\u3002"),qt=v("br",null,null,-1),Gt=i(" This is the beta version of ASTR, and it is not yet fully supporting the features in the old version of ASTR, and it is not optimized for mobile."),Vt=v("br",null,null,-1),Yt=v("br",null,null,-1),Zt=i(" \u4F60\u53EF\u4EE5"),Xt=i("\u5355\u51FB\u6B64\u5904"),Qt=i("\u8BBF\u95EE\u65E7\u7248ASTR\u3002"),en=v("br",null,null,-1),tn=i(" You can "),nn=i("click here"),on=i(" to visit the old version of ASTR."),sn=v("br",null,null,-1),rn=v("br",null,null,-1),an=i(" \u5982\u679C\u5728\u4F7F\u7528\u8FC7\u7A0B\u4E2D\u9047\u5230\u4EFB\u4F55\u95EE\u9898\uFF0C\u6216\u8005\u6709\u6539\u8FDBASTR\u7684\u597D\u70B9\u5B50\uFF0C\u8BF7\u5728"),ln=i("\u8FD9\u91CC"),cn=i("\u63D0\u4EA4issue\u3002"),_n=v("br",null,null,-1),un=i(" If you have any questions or feedbacks, please submit an issue "),pn=i("here"),dn=i("."),hn=v("br",null,null,-1),mn=v("br",null,null,-1),gn=i(" \u5982\u679C\u4F60\u559C\u6B22\u672C\u9879\u76EE\uFF0C\u53EF\u4EE5\u8003\u8651\u7ED9\u4E00\u4E2Astar\u8D44\u74F7\u4E00\u4E0B\u3002"),fn=v("br",null,null,-1),vn=i(" If you like this project, please give me a star!"),yn=v("br",null,null,-1),wn=v("img",{src:"https://img.shields.io/github/stars/050644zf/ArknightsStoryTextReader?style=social"},null,-1),Sn=v("br",null,null,-1),bn=v("br",null,null,-1),xn=i(" \u7F51\u7AD9\u5185\u4F7F\u7528\u7684\u6E38\u620F\u56FE\u7247\u548C\u6587\u672C\u539F\u6587\uFF0C\u4EC5\u7528\u4E8E\u66F4\u597D\u5730\u8868\u73B0\u6E38\u620F\u8D44\u6599\uFF0C\u5176\u7248\u6743\u5C5E\u4E8E\u4E0A\u6D77\u9E70\u89D2\u7F51\u7EDC\u79D1\u6280\u6709\u9650\u516C\u53F8\u3002"),In=v("br",null,null,-1),kn=i(" The images and text used in the website are only for better representation of the game data, and their copyright belongs to Shanghai Hypergryph Network Technology Co., Ltd."),Tn=v("br",null,null,-1),Nn=i(" \u81F4\u8C22 / Credits: "),zn=i(" \u672C\u9879\u76EE\u7684\u5B9E\u73B0\u79BB\u4E0D\u5F00\u4EE5\u4E0B\u9879\u76EE\u7684\u652F\u6301\uFF1A"),Ln=v("br",null,null,-1),Cn=i(" The implementation of this project is not without the support of the following projects: "),An=i("\u6570\u636E\u8D44\u6E90&\u66F4\u65B0\u81EA\u52A8\u5316\u652F\u6301 / Data Source & Auto Update Support: "),On=i("Kengxxiao/ArknightsGameData"),$n=i("\u5267\u60C5\u56FE\u7247\u8D44\u6E90 / Story Images Source: "),Dn=i("Aceship/AN-EN-Tags"),jn=i("\u6D3B\u52A8\u5C01\u9762\u8D44\u6E90 / Event Banners Source: "),Rn=i("PRTS Wiki"),Un=i("UI \u6846\u67B6 / UI Framework: "),En=i("Naive UI"),Jn=i("\u56FE\u6807 / Icon: "),Pn=i("xicons"),Mn=i("\u8868\u683C\u5DE5\u5177 / Spreadsheet Toolkit: "),Fn=i("Sheetjs"),Kn=i(" Todo List: "),Wn=i("Implement the export, search feature."),Hn=i("Optimize the UI in events menu & Operators' Records menu "),Bn=i("Optimize the warpping logic in menu page"),qn=i("Improve the content page");function Gn(n,r){const c=s("n-h1"),a=s("n-a"),o=s("n-icon"),l=s("n-text"),p=s("n-hr"),d=s("n-h3"),_=s("n-li"),h=s("n-ul"),f=s("n-ol"),w=s("n-space");return u(),g(w,{vertical:"",class:"homepage"},{default:t(()=>[e(c,{prefix:"bar"},{default:t(()=>[Kt,Wt,Ht]),_:1}),e(l,null,{default:t(()=>[Bt,qt,Gt,Vt,Yt,Zt,e(a,{href:"https://050644zf.github.io/ArknightsStoryTextReader/?s=zh_CN"},{default:t(()=>[Xt]),_:1}),Qt,en,tn,e(a,{href:"https://050644zf.github.io/ArknightsStoryTextReader/?s=zh_CN"},{default:t(()=>[nn]),_:1}),on,sn,rn,an,e(a,{href:"https://github.com/050644zf/ArknightsStoryTextReader/issues/new"},{default:t(()=>[ln]),_:1}),cn,_n,un,e(a,{href:"https://github.com/050644zf/ArknightsStoryTextReader/issues/new"},{default:t(()=>[pn]),_:1}),dn,hn,mn,gn,fn,vn,yn,e(a,{href:"https://github.com/050644zf/ArknightsStoryTextReader"},{default:t(()=>[e(o,null,{default:t(()=>[wn]),_:1})]),_:1}),Sn,bn,e(l,{strong:"",type:"warning"},{default:t(()=>[xn,In,kn,Tn]),_:1})]),_:1}),e(p),e(d,{prefix:"bar",type:"info"},{default:t(()=>[Nn]),_:1}),e(l,null,{default:t(()=>[zn,Ln,Cn]),_:1}),e(h,null,{default:t(()=>[e(_,null,{default:t(()=>[An,e(a,{href:"https://github.com/Kengxxiao/ArknightsGameData"},{default:t(()=>[On]),_:1})]),_:1}),e(_,null,{default:t(()=>[$n,e(a,{href:"https://github.com/Aceship/AN-EN-Tags"},{default:t(()=>[Dn]),_:1})]),_:1}),e(_,null,{default:t(()=>[jn,e(a,{href:"https://prts.wiki/"},{default:t(()=>[Rn]),_:1})]),_:1}),e(_,null,{default:t(()=>[Un,e(a,{href:"https://www.naiveui.com/"},{default:t(()=>[En]),_:1})]),_:1}),e(_,null,{default:t(()=>[Jn,e(a,{href:"https://www.xicons.org/#/"},{default:t(()=>[Pn]),_:1})]),_:1}),e(_,null,{default:t(()=>[Mn,e(a,{href:"https://github.com/SheetJS/sheetjs"},{default:t(()=>[Fn]),_:1})]),_:1})]),_:1}),e(p),e(d,{prefix:"bar",type:"info"},{default:t(()=>[Kn]),_:1}),e(f,null,{default:t(()=>[e(_,null,{default:t(()=>[Wn]),_:1}),e(_,null,{default:t(()=>[Hn]),_:1}),e(_,null,{default:t(()=>[Bn]),_:1}),e(_,null,{default:t(()=>[qn]),_:1})]),_:1})]),_:1})}var Vn=T(Ft,[["render",Gn]]);const Yn={data(){return{searchvalue:"",result:{},server:this.$route.params.server,resultNumber:0,isIncomplete:!1,isSearching:!1,eventList:window.sessionStorage.getItem("eventList")?JSON.parse(window.sessionStorage.getItem("eventList")):[]}},components:{SearchIcon:ie,OpenIcon:Ce},methods:{searchRequest(){this.isSearching=!0,this.result={},this.resultNumber="Searching";var n="https://api.github.com/search/code?q="+this.searchvalue+"+repo:050644zf/ArknightsStoryJson+path:"+this.server+"/gamedata";ae.ajaxSetup({headers:{Accept:"application/vnd.github.v3.text-match+json"}}),ae.getJSON(n).done(r=>{this.result={};const c=/.+\/gamedata\/story\/(.+)\./;this.resultNumber=r.total_count,this.isIncomplete=r.incomplete_results;var a=[],o=[],l;for(l in r.items)console.log(r.items[l].path.match(c)[1]),o.push(r.items[l].path.match(c)[1]),a.push(r.items[l].text_matches);console.log(a);var p,d,_;for(p in this.eventList){var h=this.eventList[p];for(d in h){var f=h[d],w=[];for(_ in f.infoUnlockDatas){var y=o.indexOf(f.infoUnlockDatas[_].storyTxt);y>-1&&(console.log(y),o.splice(y,1),w.push({storyCode:f.infoUnlockDatas[_].storyCode,avgTag:f.infoUnlockDatas[_].avgTag,storyName:f.infoUnlockDatas[_].storyName,storyPath:f.infoUnlockDatas[_].storyTxt,text_matches:a[y]}),a.splice(y,1))}w.length&&(this.result[f.name]=w)}}}).then(()=>{this.isSearching=!1})},parseFrag(n,r){if(n){var c;for(c in r)n=n.replaceAll(r[c].text,'<span style="color:yellow">'+r[c].text+"</span>");n=n.replaceAll("\\n","<br/>")}return n},loadStory(n){this.$router.push({path:"/"+this.server+"/content",query:{f:n}})}}},Zn=i("\xA0 "),Xn=i("\xA0 "),Qn=i(" \u5173\u4E8E\u641C\u7D22 / About Search: "),eo=i(" ASTR\u63D0\u4F9B\u57FA\u4E8EGithub API\u7684\u641C\u7D22\u529F\u80FD\u3002\u7531\u4E8EGithub API\u7684\u9650\u5236\uFF0C"),to=i("\u53EA\u80FD\u641C\u7D22\u5230\u88AB\u7A7A\u683C\u3001\u6807\u70B9\u7B26\u53F7\u6240\u5305\u56F4\u7684\u5173\u952E\u8BCD\uFF0C\u5E76\u4E14\u6BCF\u4E2A\u6587\u4EF6\u53EA\u80FD\u5C55\u793A\u4E24\u6761\u7ED3\u679C"),no=i("\u3002\u5982\u679C\u60F3\u5728\u67D0\u4E2A\u6D3B\u52A8\u5185\u7CBE\u786E\u641C\u7D22\uFF0C\u5EFA\u8BAE\u4F7F\u7528\u6D3B\u52A8\u76EE\u5F55\u9875\u7684\u201C\u5BFC\u51FA\u5230Excel\u201D\u529F\u80FD\u5728\u672C\u5730\u7684Excel\u4E2D\u641C\u7D22\u3002"),oo=v("br",null,null,-1),so=v("br",null,null,-1),ro=i(" ASTR provides search feature based on Github API. Due to the limitation of Github API, "),io=i("only the keywords surrounded by space or punctuation can be found, and each file can only show two results"),ao=i(". If you want to perform a precise search in a specific event, please use the \u201CExport to Excel\u201D feature in the event menu and search in the local excel file."),lo=v("br",null,null,-1),co=v("br",null,null,-1),_o=i("\u5F52\u6839\u7ED3\u5E95\u8FD8\u662F\u6CA1\u94B1\u642D\u670D\u52A1\u5668\uFF0C\u53EA\u80FD\u9760\u5AD6Github\u8FC7\u65E5\u5B50\u3002");function uo(n,r,c,a,o,l){const p=s("n-input"),d=s("SearchIcon"),_=s("n-icon"),h=s("n-button"),f=s("n-space"),w=s("n-h3"),y=s("n-text"),S=s("OpenIcon"),b=s("n-blockquote"),N=s("n-thing"),z=s("n-list-item"),O=s("n-list");return u(),g(f,{vertical:"",class:"searchpage"},{default:t(()=>[e(f,{"item-style":"display:flex;",align:"center",justify:"center"},{default:t(()=>[e(p,{value:o.searchvalue,"onUpdate:value":r[0]||(r[0]=L=>o.searchvalue=L),type:"text",loading:o.isSearching},null,8,["value","loading"]),e(h,{type:"info",onClick:l.searchRequest},{default:t(()=>[e(_,{size:"24"},{default:t(()=>[e(d)]),_:1})]),_:1},8,["onClick"])]),_:1}),(u(!0),x(A,null,j(o.result,(L,D,R)=>(u(),g(O,{key:R},{header:t(()=>[e(w,{prefix:"bar",style:{margin:"0px"}},{default:t(()=>[i(m(D),1)]),_:2},1024),Zn]),default:t(()=>[(u(!0),x(A,null,j(L,(I,$)=>(u(),g(z,{key:$},{default:t(()=>[e(N,null,{header:t(()=>[e(y,null,{default:t(()=>[i(m(I.storyCode)+" "+m(I.storyName),1)]),_:2},1024),Xn,e(y,{depth:"3"},{default:t(()=>[i(m(I.avgTag),1)]),_:2},1024)]),"header-extra":t(()=>[e(h,{secondary:"",type:"info"},{default:t(()=>[e(_,{size:"24"},{default:t(()=>[e(S)]),_:1})]),_:1})]),description:t(()=>[(u(!0),x(A,null,j(I.text_matches,(P,W)=>(u(),g(b,{class:"textmatch",key:W,innerHTML:l.parseFrag(P.fragment,P.matches)},null,8,["innerHTML"]))),128))]),_:2},1024)]),_:2},1024))),128))]),_:2},1024))),128)),e(y,null,{default:t(()=>[e(w,{prefix:"bar"},{default:t(()=>[Qn]),_:1}),eo,e(y,{type:"warning"},{default:t(()=>[to]),_:1}),no,oo,so,ro,e(y,{type:"warning"},{default:t(()=>[io]),_:1}),ao,lo,co,e(y,{depth:"3",delete:""},{default:t(()=>[_o]),_:1})]),_:1})]),_:1})}var po=T(Yn,[["render",uo]]);const ho={data(){return{navi:{maintheme:{icon:"terminal-maintheme",title:"main"},intermezzi:{icon:"terminal-intermezzi",title:"intermezzi"},sidestory:{icon:"terminal-sidestory",title:"ss"},storyset:{icon:"terminal-storyset",title:"mini"},or:{icon:"terminal-record",title:"or"}},i18n:J,currentLang:C.l}},components:{InfoIcon:Ae,SearchIcon:ie,Maintheme:Rt,Events:Mt,Homepage:Vn,Search:po}},mo={class:"menucontent"};function go(n,r,c,a,o,l){const p=s("InfoIcon"),d=s("n-icon"),_=s("Homepage"),h=s("n-tab-pane"),f=s("Maintheme"),w=s("Events"),y=s("SearchIcon"),S=s("Search"),b=s("n-tabs"),N=s("router-view"),z=s("n-layout-content");return u(),g(z,{class:"menupage"},{default:t(()=>[e(b,{type:"line","justify-content":"space-evenly"},{default:t(()=>[e(h,{name:"home"},{tab:t(()=>[e(d,null,{default:t(()=>[e(p)]),_:1}),i("\xA0"+m(o.i18n.homepage[o.currentLang]),1)]),default:t(()=>[e(_)]),_:1}),(u(!0),x(A,null,j(o.navi,(O,L,D)=>(u(),g(h,{name:L,key:D},{tab:t(()=>[e(d,null,{default:t(()=>[v("div",{class:M(O.icon)},null,2)]),_:2},1024),i("\xA0"+m(o.i18n[O.title][o.currentLang]),1)]),default:t(()=>[v("div",mo,[L=="maintheme"?(u(),g(f,{key:0})):(u(),g(w,{key:1,eventype:L},null,8,["eventype"]))])]),_:2},1032,["name"]))),128)),e(h,{name:"search"},{tab:t(()=>[e(d,null,{default:t(()=>[e(y)]),_:1}),i("\xA0"+m(o.i18n.search[o.currentLang]),1)]),default:t(()=>[e(S)]),_:1})]),_:1}),e(N)]),_:1})}var fo=T(ho,[["render",go]]);const vo={data(){return{eventid:this.$route.params.event,data:window.sessionStorage.getItem("menudata")?JSON.parse(window.sessionStorage.getItem("menudata")):{},infodata:window.sessionStorage.getItem("infodata")?JSON.parse(window.sessionStorage.getItem("infodata")):{},i18n:J,currentLang:C.l,showIntro:!1,server:this.$route.params.server}},components:{MenuIcon:H,ForwardIcon:re,ExportIcon:Oe},methods:{exportAll(){let n=this.data[this.eventid].infoUnlockDatas,r=this.data[this.eventid].name,c=this.eventid;window.localStorage.setItem("filename",c+"_"+r);let a=this.server,o=[];n.forEach(l=>{o.push({key:l.storyTxt,server:a,path:l.storyTxt,storyCode:l.storyCode,avgTag:l.avgTag,storyName:l.storyName})}),window.localStorage.setItem("exportList",JSON.stringify(o)),this.$router.push({path:"/"+this.server+"/export"})}}};function yo(n,r,c,a,o,l){const p=s("MenuIcon"),d=s("n-icon"),_=s("n-breadcrumb-item"),h=s("n-breadcrumb"),f=s("n-affix"),w=s("n-text"),y=s("n-switch"),S=s("n-space"),b=s("n-divider"),N=s("ExportIcon"),z=s("n-button"),O=s("n-h3"),L=s("ForwardIcon"),D=s("n-list-item"),R=s("n-list"),I=s("n-layout-content");return u(),g(I,null,{default:t(()=>[e(S,{vertical:"",class:"eventpage"},{default:t(()=>[e(f,{top:40,"trigger-top":40,position:"fixed"},{default:t(()=>[e(h,{class:"breadcrumb"},{default:t(()=>[e(_,{onClick:r[0]||(r[0]=$=>n.$router.push("/"+n.$route.params.server+"/menu"))},{default:t(()=>[e(d,null,{default:t(()=>[e(p)]),_:1}),i(" "+m(o.i18n.menu[o.currentLang]),1)]),_:1}),e(_,null,{default:t(()=>[i(m(o.data[o.eventid].name),1)]),_:1})]),_:1})]),_:1}),e(S,{"item-style":"display:flex;",align:"center"},{default:t(()=>[e(S,null,{default:t(()=>[e(w,null,{default:t(()=>[i(m(o.i18n.showIntro[o.currentLang]),1)]),_:1}),e(y,{value:o.showIntro,"onUpdate:value":r[1]||(r[1]=$=>o.showIntro=$)},null,8,["value"])]),_:1}),e(b,{vertical:""}),e(S,null,{default:t(()=>[e(z,{strong:"",secondary:"",type:"primary",onClick:l.exportAll},{icon:t(()=>[e(d,null,{default:t(()=>[e(N)]),_:1})]),default:t(()=>[i(" "+m(o.i18n.export2excel[o.currentLang]),1)]),_:1},8,["onClick"])]),_:1})]),_:1}),e(R,null,{default:t(()=>[(u(!0),x(A,null,j(o.data[o.eventid].infoUnlockDatas,($,P)=>(u(),g(D,{key:P},{suffix:t(()=>[e(z,{text:"",onClick:W=>n.$router.push({path:"/"+n.$route.params.server+"/content",query:{f:$.storyTxt}})},{default:t(()=>[e(d,{size:"32"},{default:t(()=>[e(L)]),_:1})]),_:2},1032,["onClick"])]),default:t(()=>[e(S,{vertical:""},{default:t(()=>[e(S,{"item-style":"display:flex;",align:"end"},{default:t(()=>[e(O,{style:{margin:"0px"},prefix:"bar"},{default:t(()=>[i(m($.storyName),1)]),_:2},1024),e(w,{depth:"3"},{default:t(()=>[i(m($.storyCode)+" "+m($.avgTag),1)]),_:2},1024)]),_:2},1024),B(e(w,{depth:"2"},{default:t(()=>[i(m(o.infodata[$.storyTxt]),1)]),_:2},1536),[[q,o.showIntro]])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}var wo=T(vo,[["render",yo]]);const So={data(){return{data:{},chardict:{},eventList:{},lang:"zh_CN",server:"zh_CN",i18n:{},showMenu:!0,showLangSelect:!1}},created(){this.loadData()},methods:{async loadData(){this.data=await fetch("https://raw.githubusercontent.com/Kengxxiao/ArknightsGameData/master/"+this.server+"/gamedata/excel/story_review_table.json").then(n=>n.json()),this.chardict=await fetch("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+this.server+"/chardict.json").then(n=>n.json()),this.eventList=await this.getEventList(this.data,this.chardict)},async getEventList(n,r){var c=[],a;for(a in n)if(n[a].entryType=="MAINLINE")c.push(n[a]);else if(n[a].entryType=="ACTIVITY")c.push(n[a]);else if(n[a].entryType=="MINI_ACTIVITY")c.push(n[a]);else if(n[a].entryType=="NONE"){var o=a.split("_")[1],l=a.split("_")[3];n[a].name=r[o].name+" - "+l,c.push(n[a])}return c}}};function bo(n,r,c,a,o,l){const p=s("n-layout-sider");return u(),g(p,null,{default:t(()=>[i(m(o.eventList),1)]),_:1})}var xo=T(So,[["render",bo]]);const Io={data(){return{line:this.inputline,hideName:C.hideName}},props:{inputline:Object,story:Object,lidx:Number},methods:{parseContent(n){return C.parseContent(n)},isHideName(){if(console.log([this.lidx,this.hideName,this.line]),this.lidx=="0"||this.hideName=="n"||!this.line)return!1;var n=this.story[this.lidx-1];return!!(n.prop=="name"&&n.attributes&&this.line.attributes&&n.attributes.name==this.line.attributes.name)}}},ko={class:"textblock"},To={class:M({nameblock:!0})},No=["innerHTML"];function zo(n,r,c,a,o,l){return u(),x("div",ko,[v("div",To,m(o.line.attributes.name),1),v("div",{class:"contentblock",innerHTML:l.parseContent(o.line.attributes.content)},null,8,No)])}var Lo=T(Io,[["render",zo]]);const Co={data(){return{line:this.inputline}},props:{inputline:Object},methods:{parseContent(n){return C.parseContent(n)}}},Ao=["innerHTML"];function Oo(n,r,c,a,o,l){return u(),x("div",{class:M(o.line.prop),style:le({"text-align":o.line.attributes.alignment}),innerHTML:l.parseContent(o.line.attributes.text)},null,14,Ao)}var $o=T(Co,[["render",Oo]]);const Do={data(){return{line:this.inputline}},props:{inputline:Object},methods:{parseContent(n){return C.parseContent(n)},jumpTo(n){var r=document.getElementById(n);r.scrollIntoView({behavior:"smooth",block:"center"})},addClass(n,r){var c=document.getElementById(n);c.classList.add(r)},removeClass(n,r){var c=document.getElementById(n);c.classList.remove(r)}}},jo=["onClick","onMouseover","onMouseout","innerHTML"];function Ro(n,r,c,a,o,l){return u(),x("div",{class:M(o.line.prop)},[(u(!0),x(A,null,j(o.line.attributes.values.split(";"),(p,d)=>(u(),x("div",{key:p,class:"option",onClick:_=>l.jumpTo(o.line.targetLine["option"+p]),onMouseover:_=>l.addClass(o.line.targetLine["option"+p],"PredicateFocused"),onMouseout:_=>l.removeClass(o.line.targetLine["option"+p],"PredicateFocused"),innerHTML:l.parseContent(o.line.attributes.options.split(";")[d])},null,40,jo))),128))],2)}var Uo=T(Do,[["render",Ro]]);const Eo={data(){return{line:this.inputline}},props:{inputline:Object}},Jo={key:0,class:"optText"};function Po(n,r,c,a,o,l){return u(),x("div",{class:M(o.line.prop)},[o.line.endOfOpt?E("",!0):(u(),x("div",Jo,"Options: "+m(o.line.attributes.references.replaceAll(";"," ")),1))],2)}var Mo=T(Eo,[["render",Po]]);const Fo={data(){return{line:this.inputline}},props:{inputline:Object}};function Ko(n,r,c,a,o,l){return u(),x("div",{class:M(o.line.prop),style:le({height:o.line.attributes.time*30+"px"})},null,6)}var Wo=T(Fo,[["render",Ko]]);const Ho={data(){return{line:this.inputline}},props:{inputline:Object}},Bo=["src"];function qo(n,r,c,a,o,l){return u(),x("img",{class:"Image",src:"https://aceship.github.io/AN-EN-Tags/img/avg/images/"+o.line.attributes.image+".png"},null,8,Bo)}var Go=T(Ho,[["render",qo]]);const Vo={data(){return{path:this.$route.query.f,data:{},eventid:"",server:this.$route.params.server,i18n:J,currentLang:C.l,showDelay:C.showDelay,loading:!0,loadingbar:oe(),dialog:se(),mdata:window.sessionStorage.getItem("menudata")?JSON.parse(window.sessionStorage.getItem("menudata")):{},storyOpts:[],storyIdx:-1}},created(){this.loadingbar.start(),this.getStoryData(),this.$watch(()=>this.$route.query,(n,r)=>{r.f!=n.f&&n.f&&(this.loadingbar.start(),this.path=n.f,this.getStoryData())}),this.$watch(()=>this.path,(n,r)=>{r!=n&&this.$router.push({path:"/"+this.server+"/content",query:{f:n}})})},components:{Menu:xo,Nameline:Lo,Subtitle:$o,Decision:Uo,Predicate:Mo,Delay:Wo,Showimg:Go,MenuIcon:H,ArrowDropDown:ne,LastStory:$e,NextStory:De},methods:{async getStoryData(){this.loading=!0,fetch("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+this.server+"/gamedata/story/"+this.path+".json").then(n=>n.json()).then(n=>{this.data=n,this.eventid=n.eventid}).then(()=>{this.storyOpts=this.getStoryOpts(),this.loading=!1,this.loadingbar.finish()}).catch(n=>{this.loadingbar.error(),console.log(n),this.dialog.error({title:"Fail to Load Story Data",content:"This maybe because the story is not availble in this server or the story is not exist. If you sure the story is exist in this server, please summit a issue. "})})},getStoryOpts(){var n=[],r=0;for(var c of this.mdata[this.eventid].infoUnlockDatas)n.push({value:c.storyTxt,label:c.storyCode+" "+c.storyName+" - "+c.avgTag}),c.storyTxt==this.path&&(this.storyIdx=r),r++;return n},pushStory(n){this.$router.push({path:"/"+this.server+"/content",query:{f:n}})},paging(n){this.pushStory(this.storyOpts[this.storyIdx+n].value)}}},Yo=["id"],Zo=v("div",{style:{clear:"both"}},null,-1);function Xo(n,r,c,a,o,l){const p=s("n-skeleton"),d=s("MenuIcon"),_=s("n-icon"),h=s("n-breadcrumb-item"),f=s("ArrowDropDown"),w=s("n-text"),y=s("n-popselect"),S=s("n-breadcrumb"),b=s("n-divider"),N=s("LastStory"),z=s("n-button"),O=s("NextStory"),L=s("n-button-group"),D=s("n-space"),R=s("n-affix"),I=s("n-h4"),$=s("Nameline"),P=s("Subtitle"),W=s("Decision"),de=s("Predicate"),he=s("Delay"),me=s("Showimg"),ge=s("n-layout-content"),fe=s("n-layout");return u(),g(fe,null,{default:t(()=>[e(ge,{class:"content",ref:"content"},{default:t(()=>[e(R,{top:30,"trigger-top":30,position:"fixed"},{default:t(()=>[o.loading?(u(),g(p,{key:0,class:"breadcrumb"})):(u(),g(D,{key:1,justify:"space-between","item-style":"display: flex;",align:"center",class:"breadcrumb"},{default:t(()=>[e(S,null,{default:t(()=>[e(h,{onClick:r[0]||(r[0]=k=>n.$router.push("/"+n.$route.params.server+"/menu"))},{default:t(()=>[e(_,null,{default:t(()=>[e(d)]),_:1}),i(" "+m(o.i18n.menu[o.currentLang]),1)]),_:1}),e(h,{onClick:r[1]||(r[1]=k=>n.$router.push("/"+n.$route.params.server+"/event/"+o.data.eventid))},{default:t(()=>[i(m(o.data.eventName),1)]),_:1}),e(h,null,{default:t(()=>[e(y,{options:o.storyOpts,value:o.path,"onUpdate:value":r[2]||(r[2]=k=>o.path=k),scrollable:""},{default:t(()=>[e(w,{type:"info"},{default:t(()=>[i(m(o.data.storyCode)+" "+m(o.data.storyName)+" - "+m(o.data.avgTag)+" ",1),e(_,null,{default:t(()=>[e(f)]),_:1})]),_:1})]),_:1},8,["options","value"])]),_:1})]),_:1}),e(b,{vertical:""}),e(L,null,{default:t(()=>[B(e(z,{secondary:"",round:"",type:"info",onClick:r[3]||(r[3]=k=>l.paging(-1))},{default:t(()=>[e(_,{size:"24"},{default:t(()=>[e(N)]),_:1})]),_:1},512),[[q,o.storyIdx!=0]]),B(e(z,{secondary:"",round:"",type:"info",onClick:r[4]||(r[4]=k=>l.paging(1))},{default:t(()=>[e(_,{size:"24"},{default:t(()=>[e(O)]),_:1})]),_:1},512),[[q,o.storyIdx!=o.storyOpts.length-1]])]),_:1})]),_:1}))]),_:1}),!o.data.OPTIONTRACE&&!o.loading?(u(),g(I,{key:0,prefix:"bar",type:"warning"},{default:t(()=>[i(m(o.i18n.optionTraceDisabled[o.currentLang]),1)]),_:1})):E("",!0),o.loading?(u(),g(p,{key:1,repeat:5})):(u(!0),x(A,{key:2},j(o.data.storyList,(k,ve)=>(u(),x("div",{key:k.id,class:"line",id:"line"+k.id},[k.prop=="name"?(u(),g($,{key:0,inputline:k,lidx:ve,story:o.data.storyList},null,8,["inputline","lidx","story"])):E("",!0),k.prop=="Subtitle"?(u(),g(P,{key:1,inputline:k},null,8,["inputline"])):E("",!0),k.prop=="Decision"?(u(),g(W,{key:2,inputline:k},null,8,["inputline"])):E("",!0),k.prop=="Predicate"?(u(),g(de,{key:3,inputline:k},null,8,["inputline"])):E("",!0),k.prop=="Delay"&&o.showDelay=="y"?(u(),g(he,{key:4,inputline:k},null,8,["inputline"])):E("",!0),k.prop=="Image"&&k.attributes.image?(u(),g(me,{key:5,inputline:k},null,8,["inputline"])):E("",!0),Zo],8,Yo))),128))]),_:1},512)]),_:1})}var Qo=T(Vo,[["render",Xo]]);const es={data(){return{exportList:[],filename:"export",exportFile:null,logs:`=====\u5BFC\u51FA\u65E5\u5FD7/Export Logs=====
`,i18n:J,cols:[{title:"Server",key:"server",width:100},{title:"Story Code",key:"storyCode",width:100},{title:"Avg Tag",key:"avgTag"},{title:"Story Name",key:"storyName"},{title:"Path",key:"path",ellipsis:{tooltip:!0}}],currentLang:C.l,percentage:0,processing:!1}},created(){this.exportList=window.localStorage.getItem("exportList")?JSON.parse(window.localStorage.getItem("exportList")):[],this.filename=window.localStorage.getItem("filename")?window.localStorage.getItem("filename"):"export"},methods:{removeAll(){this.exportList=[],window.localStorage.setItem("exportList",JSON.stringify(this.exportList)),this.filename="export",window.localStorage.setItem("filename",this.filename)},async exportAll(){this.processing=!0,this.percentage=0,this.logs=`Export Process Start...
`,this.logs+="Export List Length: "+this.exportList.length+`
`,this.exportFile=F.utils.book_new(),this.exportFile.Props={Title:"Exported Data",Subject:"Exported from Arknights Story Text Reader. https://050644zf.github.io/ArknightsStoryTextReader/"},this.logs+=`Workbook Created.
`,await new Promise(n=>{this.exportStories().then(n)}).then(()=>{F.writeFile(this.exportFile,this.filename+".xlsx",{type:"file"}),this.processing=!1,this.percentage=100,this.logs+=`Export Process Finished.
`})},async exportStories(){for(const n of this.exportList)await this.exportStory(n),this.percentage=Math.ceil(this.exportList.indexOf(n)/this.exportList.length*100)},async exportStory(n){this.logs+="Exporting Story: "+n.storyCode+" "+n.avgTag+" "+n.storyName+`
`;let r=await fetch("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+n.server+"/gamedata/story/"+n.path+".json");r=await r.json();let c=this.reader(r),a=F.utils.aoa_to_sheet(c);return a["!cols"]=[],a["!cols"][0]={hidden:!0,wch:15},a["!cols"][1]={wch:25},a["!cols"][2]={wch:70},await new Promise((o,l)=>{F.utils.book_append_sheet(this.exportFile,a,this.getsheetname(n.path)),o()})},getsheetname(n){const r=n.split("/").length;return n.split("/")[r-1]},reader(n){var r=[];for(var c in n.storyList){var a=n.storyList[c],o=a.id,l=a.prop,p=a.attributes;if(l=="Comment"&&r.push([o,"--Comment--",p.value]),l=="name"&&r.push([o,p.name,p.content]),l=="Dialog"&&r.push([o,"----","----"]),l=="Decision"){r.push([o,"--Decision--","----"]);var d=p.options.split(";"),_=p.values.split(";");for(let h=0;h<Math.min(d.length,_.length);h++)r.push([o,"Option_"+_[h],d[h]]);r.push([o,"--Decision End--","----"])}l=="Predicate"&&(a.endOfOpt?r.push([o,"--Branch--","End of Options"]):r.push([o,"--Branch--",">Options_"+p.references.replaceAll(";","&")])),l=="Subtitle"&&(r.push([""]),r.push([o,"",p.text]),r.push([""])),Object.keys(p).indexOf("image")!=-1&&(l=l.toLowerCase(),r.push([o,"--"+l+"--","https://aceship.github.io/AN-EN-Tags/img/avg/"+l+"s/"+p.image+".png"]))}return r},async book_append_sheet(n,r,c){return F.utils.book_append_sheet(n,r,c),await Promise.resolve("done")},home(){history.back()}},components:{MenuIcon:H,ClearIcon:je,ExportIcon:Re}},ts=i("\u5BFC\u51FA\u6587\u4EF6\u540D / Export File Name: "),ns=i(" .xlsx "),os=i("\xA0 \u6E05\u7A7A / Clear "),ss=i(" \u5BFC\u51FA / Export ");function rs(n,r,c,a,o,l){const p=s("MenuIcon"),d=s("n-icon"),_=s("n-breadcrumb-item"),h=s("n-breadcrumb"),f=s("n-data-table"),w=s("n-text"),y=s("n-input"),S=s("n-space"),b=s("ClearIcon"),N=s("n-button"),z=s("ExportIcon"),O=s("n-progress"),L=s("n-log"),D=s("n-layout-content");return u(),g(D,null,{default:t(()=>[e(S,{vertical:"",class:"exportpage"},{default:t(()=>[e(h,{class:"breadcrumb"},{default:t(()=>[e(_,{onClick:r[0]||(r[0]=R=>n.$router.push("/"+n.$route.params.server+"/menu"))},{default:t(()=>[e(d,null,{default:t(()=>[e(p)]),_:1}),i(" "+m(o.i18n.menu[o.currentLang]),1)]),_:1}),e(_,null,{default:t(()=>[i(m(o.i18n.export2excel[o.currentLang]),1)]),_:1})]),_:1}),e(f,{columns:o.cols,data:o.exportList,size:"small","max-height":"300","min-height":"300","virtual-scroll":"",striped:"",style:{width:"90%"}},null,8,["columns","data"]),e(S,{"item-style":"display: flex;",align:"center"},{default:t(()=>[e(w,null,{default:t(()=>[ts]),_:1}),e(y,{value:o.filename,"onUpdate:value":r[1]||(r[1]=R=>o.filename=R),autosize:"",size:"large"},{suffix:t(()=>[ns]),_:1},8,["value"])]),_:1}),e(S,{"item-style":"display: flex;",align:"center",justify:"end"},{default:t(()=>[e(N,{onClick:l.removeAll,type:"error"},{default:t(()=>[e(d,{size:"24"},{default:t(()=>[e(b)]),_:1}),os]),_:1},8,["onClick"]),e(N,{onClick:l.exportAll,type:"primary",loading:o.processing},{icon:t(()=>[e(d,null,{default:t(()=>[e(z)]),_:1})]),default:t(()=>[ss]),_:1},8,["onClick","loading"])]),_:1}),e(O,{type:"line",status:o.processing?"warning":"success",percentage:o.percentage,"indicator-placement":"inside",processing:o.processing},null,8,["status","percentage","processing"]),e(L,{log:o.logs,trim:"",class:"logarea"},null,8,["log"])]),_:1})]),_:1})}var is=T(es,[["render",rs]]);const as=[{path:"/:server",component:Ot,children:[{path:"menu",name:"menu",component:fo},{path:"event/:event",name:"event",component:wo},{path:"content",name:"content",component:Qo},{path:"export",name:"export",component:is}]},{path:"/",redirect:"/zh_CN/menu"}],ls=Ue({history:Ee(),routes:as}),ee=Je(Lt);ee.use(Pe);ee.use(ls);ee.mount("#ASTR");
