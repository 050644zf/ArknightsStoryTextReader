import{_,o as i,c,a as n,t as p,n as b,r as m,w as y,v as $,F as x,b as w,d as k,$ as N,e as E,f as O,g as j,h as v,i as B,j as T,k as F,l as C,m as D}from"./jquery.35eba1a5.js";import{f as u,h as R}from"./func.4d364ffe.js";import{i as z}from"./i18n.cce29cd3.js";const J={props:["story"],emits:["hidemenu","focusstory","unfoldevent"],data(){return{focused:!1,lang:u.l,server:u.server}},mounted(){u.storyFile==this.story.storyTxt&&(this.focused=!0,this.$emit("unfoldevent"))},methods:{loadStory(o){var t="s="+this.server;t=t+"&f="+o,window.location.search=t}}},P=["id"],V={class:"storycode xst"},H={class:"storyname nt"};function q(o,t,s,l,e,r){return i(),c("div",{class:b({story:!0,storyFocused:e.focused,nt:!0}),id:s.story.storyId,onClick:t[0]||(t[0]=a=>r.loadStory(s.story.storyTxt))},[n("div",V,p(s.story.storyCode)+" "+p(s.story.avgTag),1),n("div",H,p(s.story.storyName),1)],10,P)}var Y=_(J,[["render",q]]);const G={props:["event","eventid"],emits:["hidemenu","focusStory"],data(){return{collapsed:!0}},components:{Storymenu:Y}},K={class:"event"},W={class:"stories"};function Q(o,t,s,l,e,r){const a=m("Storymenu");return i(),c("div",K,[n("div",{class:b({eventname:!0,eventnamehl:!e.collapsed,lt:!0})},p(s.event.name),3),y(n("div",W,[(i(!0),c(x,null,w(s.event.infoUnlockDatas,(d,h)=>(i(),k(a,{story:d,onUnfoldevent:t[0]||(t[0]=f=>{e.collapsed=!1,o.$emit("focusStory")}),key:h},null,8,["story"]))),128))],512),[[$,!e.collapsed]])])}var X=_(G,[["render",Q]]);const Z={data(){return{data:{},chardict:{},eventList:{},lang:u.l,server:u.server,i18n:z,showMenu:!0,showLangSelect:!1}},created(){N.getJSON("https://raw.githubusercontent.com/Kengxxiao/ArknightsGameData/master/"+this.server+"/gamedata/excel/story_review_table.json").done(o=>{this.data=o,N.getJSON("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+this.server+"/chardict.json").done(t=>{this.chardict=t,this.eventList=this.getEventList(this.data,this.chardict)})})},mounted(){u.focus()},methods:{serverSwitch(o){var t="s="+o;window.location.search=t},getEventList(o,t){var s=[],l;for(l in o)if(o[l].entryType=="MAINLINE")s.push(o[l]);else if(o[l].entryType=="ACTIVITY")s.push(o[l]);else if(o[l].entryType=="MINI_ACTIVITY")s.push(o[l]);else if(o[l].entryType=="NONE"){var e=l.split("_")[1],r=l.split("_")[3];o[l].name=t[e].name+" - "+r,s.push(o[l])}return s},focusStory(){u.focus()},home(){window.location.search="?s="+this.server}},components:{Eventmenu:X}},ee={id:"sidebar"},te={id:"currentLang",class:"currentLang lt"},ne=n("span",{class:"material-icons",style:{"margin-right":"5px"}},"language",-1),oe={id:"langSelect",class:"langSelect lt"},se=["onClick"],re=n("span",{class:"material-icons"}," menu_open ",-1),ie={class:"home"};function ae(o,t,s,l,e,r){const a=m("Eventmenu");return i(),c("div",ee,[n("div",{class:b({menuButton:!0,"material-icons":!0,menuButtonR:e.showMenu}),onClick:t[0]||(t[0]=d=>{e.showMenu=!e.showMenu})},"chevron_right",2),n("div",{class:b({sidebar:!0,sidebarhidden:!e.showMenu})},[n("div",te,[n("div",{style:{display:"flex","align-items":"center","justify-content":"center"},onClick:t[1]||(t[1]=d=>e.showLangSelect=!e.showLangSelect)},[ne,n("span",null,p(e.i18n.server[e.server]),1)]),y(n("div",oe,[(i(!0),c(x,null,w(e.i18n.server,(d,h,f)=>(i(),c("div",{onClick:S=>r.serverSwitch(h),key:f},p(d),9,se))),128))],512),[[$,e.showLangSelect]])]),n("div",{class:"homepage nt",onClick:t[2]||(t[2]=d=>r.home())},[re,n("span",ie,p(e.i18n.home[e.lang]),1)]),(i(!0),c(x,null,w(e.eventList,(d,h)=>(i(),k(a,{class:"event",id:d.id,event:d,lang:e.lang,onHidemenu:t[3]||(t[3]=f=>e.showMenu=!1),key:h},null,8,["id","event","lang"]))),128))],2)])}var le=_(Z,[["render",ae]]);const ce={data(){return{doctor:u.doctor,i18n:z,lang:u.l,targetLang:u.l,show:this.doctor=="{@nickname}",hidetip:u.hidetip,showDelay:u.showDelay,hideName:u.hideName,langList:u.langList,isOldversion:!0}},methods:{save(){window.localStorage.setItem("doctor",this.doctor),window.localStorage.setItem("showDelay",this.showDelay),window.localStorage.setItem("hideName",this.hideName),window.localStorage.setItem("lang",this.targetLang),window.location.href=window.location.href},clearSetting(){window.localStorage.clear(),window.location.href=window.location.href},hide(){this.hidetip=!0,window.localStorage.setItem("hidetip",!0)},hide2(){this.isOldversion=!1,window.localStorage.setItem("isOldversion",!1)},getJSONFile(){return"https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+this.lang+"/gamedata/story/"+u.storyFile+".json"},getUserAgent(){return window.navigator.userAgent},getWidth(){return N(window).width()}}},de={id:"setting"},ue={class:"warmtip",style:{"background-color":"rgb(255, 255, 0)",color:"#000",padding:"5px"}},pe=n("span",{style:{float:"left","margin-left":"20px"}},[v("If you like this project, please give me a star "),n("a",{href:"https://github.com/050644zf/ArknightsStoryTextReader",style:{color:"rgb(32, 32, 184)"}},"here"),v("!"),n("br"),v("If you have any issues or feedbacks please summit them "),n("a",{href:"https://github.com/050644zf/ArknightsStoryTextReader/issues",style:{color:"rgb(32, 32, 184)"}},"here"),v(".")],-1),he=n("div",{style:{clear:"both"}},null,-1),me={class:"warmtip",style:{"background-color":"rgb(43 118 61)",padding:"5px"}},ge=n("span",{style:{float:"left","margin-left":"20px"}},[v(" New version of Arknights Story Text Reader has been released! "),n("a",{href:"https://050644zf.github.io/ArknightsStoryTextReader/index2.html"},"Check it out!"),n("br"),v(" \u660E\u65E5\u65B9\u821F\u5267\u60C5\u6587\u672C\u9605\u8BFB\u5668\u5DF2\u53D1\u5E03\u65B0\u7248\u672C\uFF0C"),n("a",{href:"https://050644zf.github.io/ArknightsStoryTextReader/index2.html"},"\u70B9\u6B64\u8BBF\u95EE\u65B0\u7248\uFF01")],-1),_e=n("div",{style:{clear:"both"}},null,-1),fe={class:"settingtitle nt"},ve=n("span",{class:"material-icons clearbutton",style:{float:"right",padding:"4px"}},"delete",-1),ye={class:"settingtitle nt",style:{float:"right","font-weight":"normal"}},xe=n("div",{style:{clear:"both"}},null,-1),be={class:b({settingoptions:!0,nt:!0})},ke=n("span",{class:"material-icons"},"public",-1),we=n("div",{style:{clear:"both"}},null,-1),Se={style:{float:"left"}},$e=n("div",{style:{clear:"both"}},null,-1),Le={style:{float:"left"}},Te=n("div",{style:{clear:"both"}},null,-1),Ce={style:{float:"left"}},Ne=n("div",{style:{clear:"both"}},null,-1),ze={style:{float:"left","font-weight":"bold"}},Ie=n("span",{class:"material-icons",style:{float:"left"}},"save_alt",-1),Ae=n("div",{style:{clear:"both"}},null,-1),je=n("span",{class:"xxst",style:{"font-weight":"bold",color:"dimgray"}}," Developer Info/Options (Please attach these info with your issues) ",-1),Oe={class:"xxst",style:{color:"dimgray"}},Be=v(" Current JsonFile:"),Me=n("br",null,null,-1),Ue=n("br",null,null,-1),Ee=v(" Browser Info:"),Fe=n("br",null,null,-1),De=n("br",null,null,-1),Re=n("br",null,null,-1);function Je(o,t,s,l,e,r){return i(),c("div",de,[y(n("div",ue,[pe,n("span",{class:"material-icons",style:{float:"right"},onClick:t[0]||(t[0]=a=>r.hide())},"clear"),he],512),[[$,!e.hidetip]]),y(n("div",me,[ge,n("span",{class:"material-icons",style:{float:"right"},onClick:t[1]||(t[1]=a=>r.hide2())},"clear"),_e],512),[[$,e.isOldversion]]),n("div",{class:b({setting:!0,settingshow:e.show})},[n("span",{class:b({"material-icons":!0}),onClick:t[2]||(t[2]=a=>e.show=!e.show),id:"settingbutton"}," settings "),n("span",fe,p(e.i18n.setting[e.lang]),1),n("div",{class:"clear",onClick:t[3]||(t[3]=a=>r.clearSetting())},[ve,n("span",ye,p(e.i18n.clear[e.lang]),1)]),xe,y(n("div",be,[ke,y(n("select",{"onUpdate:modelValue":t[4]||(t[4]=a=>e.targetLang=a)},[(i(!0),c(x,null,w(e.langList,a=>(i(),c("option",{key:a},p(a),1))),128))],512),[[E,e.targetLang]]),we,n("span",Se,p(e.i18n.dr[e.lang])+": ",1),y(n("input",{class:"textbox","onUpdate:modelValue":t[5]||(t[5]=a=>e.doctor=a),style:{float:"left"}},null,512),[[O,e.doctor]]),$e,n("span",Le,p(e.i18n.showDelay[e.lang])+": ",1),y(n("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=a=>e.showDelay=a),"true-value":"y","false-value":"n",style:{float:"left"}},null,512),[[j,e.showDelay]]),Te,n("span",Ce,p(e.i18n.hideName[e.lang])+"(beta): ",1),y(n("input",{class:"checkbox",type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=a=>e.hideName=a),"true-value":"y","false-value":"n",style:{float:"left"}},null,512),[[j,e.hideName]]),Ne,n("div",{class:"save",onClick:t[8]||(t[8]=a=>r.save())},[n("span",ze,p(e.i18n.save[e.lang]),1),Ie,Ae]),je,n("div",Oe,[Be,Me,v(" "+p(r.getJSONFile()),1),Ue,Ee,Fe,v(" "+p(r.getUserAgent()),1),De,v(" Browser width: "+p(r.getWidth()),1),Re])],512),[[$,e.show]])],2)])}var Pe=_(ce,[["render",Je]]);const Ve={data(){return{line:this.inputline,hideName:!1}},mounted(){this.hideName=this.isHideName()},props:{inputline:Object,story:Object,lidx:Number},methods:{parseContent(o){return u.parseContent(o)},isHideName(){if(this.lidx=="0"||u.hideName=="n"||!this.line)return!1;var o=this.story[this.lidx-1];return!!(o.prop=="name"&&o.attributes&&this.line.attributes&&(console.log(o),o.attributes.name==this.line.attributes.name))}}},He={class:"textblock"},qe=["innerHTML"];function Ye(o,t,s,l,e,r){return i(),c("div",He,[n("div",{class:b({nameblock:!0,hideName:e.hideName})},p(e.line.attributes.name),3),n("div",{class:"contentblock",innerHTML:r.parseContent(e.line.attributes.content)},null,8,qe)])}var Ge=_(Ve,[["render",Ye]]);const Ke={data(){return{line:this.inputline}},props:{inputline:Object},methods:{parseContent(o){return u.parseContent(o)}}},We=["innerHTML"];function Qe(o,t,s,l,e,r){return i(),c("div",{class:b(e.line.prop),style:B({"text-align":e.line.attributes.alignment}),innerHTML:r.parseContent(e.line.attributes.text)},null,14,We)}var Xe=_(Ke,[["render",Qe]]);const Ze={data(){return{line:this.inputline}},props:{inputline:Object},methods:{parseContent(o){return u.parseContent(o)},jumpTo(o){var t=document.getElementById(o);t.scrollIntoView({behavior:"smooth",block:"center"})},addClass(o,t){var s=document.getElementById(o);s.classList.add(t)},removeClass(o,t){var s=document.getElementById(o);s.classList.remove(t)}}},et=["onClick","onMouseover","onMouseout","innerHTML"];function tt(o,t,s,l,e,r){return i(),c("div",{class:b(e.line.prop)},[(i(!0),c(x,null,w(e.line.attributes.values.split(";"),(a,d)=>(i(),c("div",{key:a,class:"option",onClick:h=>r.jumpTo(e.line.targetLine["option"+a]),onMouseover:h=>r.addClass(e.line.targetLine["option"+a],"PredicateFocused"),onMouseout:h=>r.removeClass(e.line.targetLine["option"+a],"PredicateFocused"),innerHTML:r.parseContent(e.line.attributes.options.split(";")[d])},null,40,et))),128))],2)}var nt=_(Ze,[["render",tt]]);const ot={data(){return{line:this.inputline}},props:{inputline:Object}},st={key:0,class:"optText"};function rt(o,t,s,l,e,r){return i(),c("div",{class:b(e.line.prop)},[e.line.endOfOpt?T("",!0):(i(),c("div",st,"Options: "+p(e.line.attributes.references.replaceAll(";"," ")),1))],2)}var it=_(ot,[["render",rt]]);const at={data(){return{line:this.inputline}},props:{inputline:Object}};function lt(o,t,s,l,e,r){return i(),c("div",{class:b(e.line.prop),style:B({height:e.line.attributes.time*30+"px"})},null,6)}var ct=_(at,[["render",lt]]);const dt={data(){return{line:this.inputline}},props:{inputline:Object}},ut=["src"];function pt(o,t,s,l,e,r){return i(),c("img",{class:"Image",src:"https://raw.githubusercontent.com/Aceship/Arknight-Images/main/avg/images/"+e.line.attributes.image+".png"},null,8,ut)}var ht=_(dt,[["render",pt]]);const mt={data(){return{data:u.storyData,path:u.storyFile,lang:u.l,server:u.server,doctor:u.doctor,i18n:z,showDelay:u.showDelay}},created(){this.path?N.getJSON("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+this.server+"/gamedata/story/"+this.path+".json").done(o=>this.data=o).fail(o=>{this.data={eventName:"Error on loading json file: "+this.path+"! If this is a new story, please contact the developer in github issue or discord to update the database."}}):this.data={eventName:"< - "+z.selectStory[this.lang]}},updated(){if(u.urlParams.get("warp")){var o=document.getElementById(u.urlParams.get("warp"));o&&(o.scrollIntoView({behavior:"smooth",block:"center"}),o.style.setProperty("background-color","#f4433633"))}u.focus()},methods:{jumpTo(o){var t=document.getElementById(o);t.scrollIntoView({behavior:"smooth",block:"center"})},changeColor(o,t){var s=document.getElementById(o);setInterval(s.style.setProperty("background-color",t),500)},getURL(o,t,s){return"?s="+o+"&f="+t+"&warp=line"+s},parseContent(o){return u.parseContent(o)}},components:{Nameline:Ge,Subtitle:Xe,Decision:nt,Predicate:it,Delay:ct,Showimg:ht}},gt={id:"content"},_t={class:"storydata",id:"storydata"},ft=["id"],vt=["href"],yt=n("div",{style:{clear:"both"}},null,-1);function xt(o,t,s,l,e,r){const a=m("Nameline"),d=m("Subtitle"),h=m("Decision"),f=m("Predicate"),S=m("Delay"),L=m("Showimg");return i(),c("div",gt,[n("div",_t,p(e.data.eventName)+" "+p(e.data.storyCode)+" "+p(e.data.avgTag)+" "+p(e.data.storyName),1),(i(!0),c(x,null,w(e.data.storyList,(g,I)=>(i(),c("div",{key:g.id,class:"line",id:"line"+g.id},[n("a",{href:r.getURL(e.server,e.path,g.id),class:"linkButton material-icons"},"link",8,vt),g.prop=="name"?(i(),k(a,{key:0,inputline:g,lidx:I,story:e.data.storyList},null,8,["inputline","lidx","story"])):T("",!0),g.prop=="Subtitle"?(i(),k(d,{key:1,inputline:g},null,8,["inputline"])):T("",!0),g.prop=="Decision"?(i(),k(h,{key:2,inputline:g},null,8,["inputline"])):T("",!0),g.prop=="Predicate"?(i(),k(f,{key:3,inputline:g},null,8,["inputline"])):T("",!0),g.prop=="Delay"&&e.showDelay=="y"?(i(),k(S,{key:4,inputline:g},null,8,["inputline"])):T("",!0),g.prop=="Image"&&g.attributes.image?(i(),k(L,{key:5,inputline:g},null,8,["inputline"])):T("",!0),yt],8,ft))),128))])}var bt=_(mt,[["render",xt]]);const kt={methods:{scrollToTop(){document.getElementById("storydata").scrollIntoView({behavior:"smooth",block:"center"})}}};function wt(o,t,s,l,e,r){return i(),c("span",{class:"material-icons topButton",onClick:t[0]||(t[0]=a=>r.scrollToTop())},"vertical_align_top")}var St=_(kt,[["render",wt]]);const $t={props:{item:Object,iidx:Number,focus:Boolean},emits:["focusme"]},Lt={key:1,class:"material-icons itemicon lt"},Tt={class:"itemname st"};function Ct(o,t,s,l,e,r){return i(),c("div",{class:b({navitem:!0,itemfocused:s.focus}),onClick:t[0]||(t[0]=a=>{o.$emit("focusme")})},[s.item.icon!="search"?(i(),c("div",{key:0,class:b([s.item.icon,"itemicon","lt"])},null,2)):T("",!0),s.item.icon=="search"?(i(),c("span",Lt,"search")):T("",!0),n("span",Tt,p(s.item.title),1)],2)}var Nt=_($t,[["render",Ct]]);const zt={data(){return{navi:{maintheme:{icon:"terminal-maintheme",title:"Maintheme"},intermezzi:{icon:"terminal-intermezzi",title:"Intermezzi"},sidestory:{icon:"terminal-sidestory",title:"Sidestory"},storyset:{icon:"terminal-storyset",title:"Storyset"},or:{icon:"terminal-record",title:"Records"},search:{icon:"search",title:"Search (Beta)"}}}},emits:["focuson"],props:{focus:Number},components:{Navitem:Nt}},It={class:"navibar"};function At(o,t,s,l,e,r){const a=m("Navitem");return i(),c("div",It,[(i(!0),c(x,null,w(e.navi,(d,h,f)=>(i(),k(a,{key:h,item:d,onFocusme:S=>{s.focus=f,o.$emit("focuson",f)},focus:s.focus==f},null,8,["item","onFocusme","focus"]))),128))])}var jt=_(zt,[["render",At]]);const Ot={data(){return{server:u.server,i18n:z,lang:u.l}},emits:["focusme"],props:{eventData:Object,showStory:Boolean},methods:{exportAll(){let o=this.eventData.infoUnlockDatas,t=this.eventData.name,s=this.eventData.set;window.localStorage.setItem("filename",t+"_"+s);let l=this.server,e=[];o.forEach(r=>{e.push({server:l,path:r.storyTxt,storyCode:r.storyCode,avgTag:r.avgTag,storyName:r.storyName})}),window.localStorage.setItem("exportList",JSON.stringify(e)),window.location.href="export.html"},getAvatar(){return"https://raw.githubusercontent.com/Aceship/Arknight-Images/main/avatars/char_"+this.eventData.cid+"_"+this.eventData.cin+".png"},loadStory(o){var t="s="+this.server;t=t+"&f="+o,window.location.search=t}}},Bt=["src"],Mt={class:"operatorname"},Ut={class:"setnumber"},Et={class:"orstories"},Ft={class:"exportBar nt"},Dt=n("span",{class:"material-icons"}," file_download ",-1),Rt=["onClick"];function Jt(o,t,s,l,e,r){return i(),c("div",{class:b({oritem:!0,orfocused:s.showStory,lt:!0})},[n("div",{class:"orcard",onClick:t[0]||(t[0]=a=>o.$emit("focusme"))},[n("img",{src:r.getAvatar()},null,8,Bt),n("div",Mt,p(s.eventData.name),1),n("div",Ut,"#"+p(s.eventData.set),1)]),y(n("div",Et,[n("div",Ft,[n("div",{onClick:t[1]||(t[1]=a=>r.exportAll())},[Dt,n("span",null,p(e.i18n.export2excel[e.lang]),1)])]),(i(!0),c(x,null,w(s.eventData.infoUnlockDatas,(a,d)=>(i(),c("div",{class:"orstory",key:d,onClick:h=>r.loadStory(a.storyTxt)},p(d)+". "+p(a.storyName),9,Rt))),128))],512),[[$,s.showStory]])],2)}var Pt=_(Ot,[["render",Jt]]);const Vt={data(){return{focus:-1}},props:{eventList:Array},components:{Oritem:Pt},methods:{focuson(o){this.focus==o?this.focus=-1:this.focus=o}}},Ht={class:"record"};function qt(o,t,s,l,e,r){const a=m("Oritem");return i(),c("div",Ht,[(i(!0),c(x,null,w(s.eventList,(d,h)=>(i(),k(a,{key:h,eventData:d,"show-story":e.focus==h,onFocusme:f=>r.focuson(h)},null,8,["eventData","show-story","onFocusme"]))),128))])}var Yt=_(Vt,[["render",qt]]);const Gt={props:["story"],emits:["hidemenu","focusstory","unfoldevent"],data(){return{focused:!1,lang:u.l,server:u.server}},mounted(){u.storyFile==this.story.storyTxt&&(this.focused=!0,this.$emit("unfoldevent"))},methods:{loadStory(o,t){var s="s="+this.server;s=s+"&f="+t,window.location.search=s}}},Kt=["id"],Wt={class:"storycode xst"},Qt={class:"storyname nt"};function Xt(o,t,s,l,e,r){return i(),c("div",{class:b({story:!0,storyFocused:e.focused}),id:s.story.storyId,onClick:t[0]||(t[0]=a=>r.loadStory(e.lang,s.story.storyTxt))},[n("div",Wt,p(s.story.storyCode)+" "+p(s.story.avgTag),1),n("div",Qt,p(s.story.storyName),1)],10,Kt)}var Zt=_(Gt,[["render",Xt]]);const en={props:["event","eventid"],emits:["hidemenu","focusStory"],data(){return{collapsed:!0,i18n:z,lang:u.l,server:u.server}},methods:{exportAll(){let o=this.event.infoUnlockDatas,t=this.event.name,s=this.eventid;window.localStorage.setItem("filename",s+"_"+t);let l=this.server,e=[];o.forEach(r=>{e.push({server:l,path:r.storyTxt,storyCode:r.storyCode,avgTag:r.avgTag,storyName:r.storyName})}),window.localStorage.setItem("exportList",JSON.stringify(e)),window.location.href="export.html"}},components:{Storymenu:Zt}},tn={class:"event"},nn={class:"stories"},on={class:"exportBar"},sn=n("span",{class:"material-icons"}," file_download ",-1);function rn(o,t,s,l,e,r){const a=m("Storymenu");return i(),c("div",tn,[n("div",{class:b({eventname:!0,eventnamehl:!e.collapsed,lt:!0}),onClick:t[0]||(t[0]=d=>e.collapsed=!e.collapsed)},p(s.event.name),3),y(n("div",nn,[n("div",on,[n("div",{onClick:t[1]||(t[1]=d=>r.exportAll())},[sn,n("span",null,p(e.i18n.export2excel[e.lang]),1)])]),(i(!0),c(x,null,w(s.event.infoUnlockDatas,(d,h)=>(i(),k(a,{story:d,onUnfoldevent:t[2]||(t[2]=f=>{e.collapsed=!1,o.$emit("focusStory")}),key:h},null,8,["story"]))),128))],512),[[$,!e.collapsed]])])}var A=_(en,[["render",rn]]);const an={props:{eventList:Object},components:{Eventmenu:A}},ln={class:"maintheme"};function cn(o,t,s,l,e,r){const a=m("Eventmenu");return i(),c("div",ln,[(i(!0),c(x,null,w(s.eventList,(d,h)=>(i(),k(a,{key:h,event:d,eventid:d.id},null,8,["event","eventid"]))),128))])}var dn=_(an,[["render",cn]]);const un={props:{eventList:Object},components:{Eventmenu:A}},pn={class:"intermezzi"};function hn(o,t,s,l,e,r){const a=m("Eventmenu");return i(),c("div",pn,[(i(!0),c(x,null,w(s.eventList,(d,h)=>(i(),k(a,{key:h,event:d,eventid:d.id},null,8,["event","eventid"]))),128))])}var mn=_(un,[["render",hn]]);const gn={props:{eventList:Object},components:{Eventmenu:A}},_n={class:"sidestory"};function fn(o,t,s,l,e,r){const a=m("Eventmenu");return i(),c("div",_n,[(i(!0),c(x,null,w(s.eventList,(d,h)=>(i(),k(a,{key:h,event:d,eventid:d.id},null,8,["event","eventid"]))),128))])}var vn=_(gn,[["render",fn]]);const yn={props:{eventList:Object},components:{Eventmenu:A}},xn={class:"storyset"};function bn(o,t,s,l,e,r){const a=m("Eventmenu");return i(),c("div",xn,[(i(!0),c(x,null,w(s.eventList,(d,h)=>(i(),k(a,{key:h,event:d,eventid:d.id},null,8,["event","eventid"]))),128))])}var kn=_(yn,[["render",bn]]);const wn={data(){return{searchvalue:"",result:{},server:u.server,resultNumber:0,isIncomplete:!1,isSearching:!1}},props:{eventList:Object},methods:{searchRequest(){this.isSearching=!0,this.result={},this.resultNumber="Searching";var o="https://api.github.com/search/code?q="+this.searchvalue+"+repo:050644zf/ArknightsStoryJson+path:"+this.server+"/gamedata";N.ajaxSetup({headers:{Accept:"application/vnd.github.v3.text-match+json"}}),N.getJSON(o).done(t=>{this.result={};const s=/.+\/gamedata\/story\/(.+)\./;this.resultNumber=t.total_count,this.isIncomplete=t.incomplete_results;var l=[],e=[],r;for(r in t.items)console.log(t.items[r].path.match(s)[1]),e.push(t.items[r].path.match(s)[1]),l.push(t.items[r].text_matches);console.log(l);var a,d,h;for(a in this.eventList){var f=this.eventList[a];for(d in f){var S=f[d],L=[];for(h in S.infoUnlockDatas){var g=e.indexOf(S.infoUnlockDatas[h].storyTxt);g>-1&&(console.log(g),e.splice(g,1),L.push({storyCode:S.infoUnlockDatas[h].storyCode,avgTag:S.infoUnlockDatas[h].avgTag,storyName:S.infoUnlockDatas[h].storyName,storyPath:S.infoUnlockDatas[h].storyTxt,text_matches:l[g]}),l.splice(g,1))}L.length&&(this.result[S.name]=L)}}}),this.isSearching=!1},parseFrag(o,t){if(o){var s;for(s in t)o=o.replaceAll(t[s].text,'<span style="color:yellow">'+t[s].text+"</span>");o=o.replaceAll("\\n","<br/>")}return o},loadStory(o){var t="s="+this.server;t=t+"&f="+o,window.location.search=t}}},Sn={class:"search"},$n=n("br",null,null,-1),Ln={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Tn={class:"resulttitle"},Cn={style:{"font-size":"smaller"}},Nn=n("br",null,null,-1),zn=["onClick"],In=["innerHTML"],An=n("div",{class:"st",style:{margin:"10%",color:"rgba(255,255,255,0.7)"}},[n("p",{style:{"text-align":"center"}},"The search feature is powered by Github API."),n("p",{style:{"font-weight":"bold"}},"Didn't find the expected result?"),n("p",null,[v("The Github code search only return the result that the target text is exactly surrounded by "),n("span",{style:{"font-weight":"bold"}},"spaces or punctuation"),v(". Try using plural noun or change its tense to get more results. ")])],-1);function jn(o,t,s,l,e,r){return i(),c("div",Sn,[n("div",{class:b({searchbar:!0,searching:e.isSearching,nt:!0})},[y(n("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>e.searchvalue=a),onKeyup:t[1]||(t[1]=F(a=>r.searchRequest(),["enter"]))},null,544),[[O,e.searchvalue]]),n("span",{class:"material-icons",onClick:t[2]||(t[2]=a=>r.searchRequest())},"search")],2),n("div",{class:b({searchresult:!0,searching:e.isSearching})},[v(p(e.resultNumber)+" results",1),$n,(i(!0),c(x,null,w(e.result,(a,d,h)=>(i(),c("div",{key:h,style:{"font-weight":"bold",margin:"5px"}},[v(p(d)+" ",1),(i(!0),c(x,null,w(a,(f,S)=>(i(),c("div",{key:S,style:{"font-weight":"normal","margin-left":"20px"}},[n("div",Ln,[n("div",Tn,[n("span",Cn,p(f.storyCode)+" "+p(f.avgTag),1),Nn,n("span",null,p(f.storyName),1)]),n("span",{class:"material-icons loadButton",onClick:L=>r.loadStory(f.storyPath)},"open_in_new",8,zn)]),(i(!0),c(x,null,w(f.text_matches,(L,g)=>(i(),c("div",{class:"textmatch",key:g,innerHTML:r.parseFrag(L.fragment,L.matches)},null,8,In))),128))]))),128))]))),128))],2),An])}var On=_(wn,[["render",jn]]);const Bn={data(){return{focus:0,i18n:z,lang:u.l,server:u.server,chardict:{},intermezzi:u.intermezzi,eventList:{},data:{},showLangSelect:!1}},created(){N.getJSON("https://raw.githubusercontent.com/Kengxxiao/ArknightsGameData/master/"+this.server+"/gamedata/excel/story_review_table.json").done(o=>{this.data=o,N.getJSON("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/"+this.server+"/chardict.json").done(t=>{this.chardict=t,this.eventList=this.getEventList(this.data,this.chardict)})})},components:{Navibar:jt,Maintheme:dn,Intermezzi:mn,Sidestory:vn,Storyset:kn,Or:Yt,Search:On},methods:{serverSwitch(o){var t="s="+o;window.location.search=t},getEventList(o,t){var s={maintheme:[],intermezzi:[],sidestory:[],storyset:[],or:[]},l;for(l in o)if(o[l].entryType=="MAINLINE")s.maintheme.push(o[l]);else if(o[l].entryType=="ACTIVITY")this.intermezzi.indexOf(l)==-1?s.sidestory.push(o[l]):s.intermezzi.push(o[l]);else if(o[l].entryType=="MINI_ACTIVITY")s.storyset.push(o[l]);else if(o[l].entryType=="NONE"){var e=l.split("_")[1],r=l.split("_")[3];o[l].name=t[e].name,o[l].cid=t[e].id,o[l].cin=e,o[l].set=r,s.or.push(o[l])}return s.intermezzi.sort(function(a,d){return a.startTime-d.startTime}),s.sidestory.sort(function(a,d){return a.startTime-d.startTime}),s.storyset.sort(function(a,d){return a.startTime-d.startTime}),s}}},Mn={class:"menupage"},Un={id:"currentLang lt",class:"currentLang"},En=n("span",{class:"material-icons lt",style:{"margin-right":"5px"}},"language",-1),Fn={class:"lt"},Dn={id:"langSelect",class:"langSelect lt"},Rn=["onClick"],Jn=n("br",null,null,-1);function Pn(o,t,s,l,e,r){const a=m("Navibar"),d=m("Maintheme"),h=m("Intermezzi"),f=m("Sidestory"),S=m("Storyset"),L=m("Or"),g=m("Search");return i(),c("div",Mn,[n("div",Un,[n("div",{style:{display:"flex","align-items":"center","justify-content":"center"},onClick:t[0]||(t[0]=I=>e.showLangSelect=!e.showLangSelect)},[En,n("span",Fn,p(e.i18n.server[e.server]),1)]),y(n("div",Dn,[(i(!0),c(x,null,w(e.i18n.server,(I,M,U)=>(i(),c("div",{onClick:mo=>r.serverSwitch(M),key:U},p(I),9,Rn))),128))],512),[[$,e.showLangSelect]])]),Jn,C(a,{focus:e.focus,onFocuson:t[1]||(t[1]=I=>e.focus=I)},null,8,["focus"]),y(C(d,{eventList:e.eventList.maintheme},null,8,["eventList"]),[[$,e.focus==0]]),y(C(h,{eventList:e.eventList.intermezzi},null,8,["eventList"]),[[$,e.focus==1]]),y(C(f,{eventList:e.eventList.sidestory},null,8,["eventList"]),[[$,e.focus==2]]),y(C(S,{eventList:e.eventList.storyset},null,8,["eventList"]),[[$,e.focus==3]]),y(C(L,{eventList:e.eventList.or},null,8,["eventList"]),[[$,e.focus==4]]),y(C(g,{eventList:e.eventList},null,8,["eventList"]),[[$,e.focus==5]])])}var Vn=_(Bn,[["render",Pn]]);const Hn={data(){return{storyData:{},storyFile:u.storyFile,lang:u.l,server:u.server,latestUpdate:0}},created(){N.getJSON("https://raw.githubusercontent.com/050644zf/ArknightsStoryJson/main/log.json").done(o=>{console.log(o),this.latestUpdate=o.latestCommitTime})},components:{Header:R,Menu:le,Content:bt,Settings:Pe,Topbtn:St,Menupage:Vn},methods:{dateFormatter(o){var t=new Date(o*1e3),s="";return s=t.getUTCFullYear()+"-"+(t.getUTCMonth()+1)+"-"+t.getUTCDate()+" "+t.getUTCHours()+":"+t.getUTCMinutes()+":"+t.getUTCSeconds(),s}}},qn=n("hr",null,null,-1),Yn={class:"footer"},Gn=n("div",{class:"links st"},[n("a",{href:"https://github.com/050644zf/ArknightsStoryTextReader"},"Project Repo / \u9879\u76EE\u4ED3\u5E93"),n("br"),n("br"),n("a",{href:"https://github.com/050644zf/ArknightsStoryTextReader/issues"},"Bug Report & Feedbacks / \u95EE\u9898\u53CD\u9988\u548C\u5EFA\u8BAE"),n("br"),n("br")],-1),Kn={class:"info st"},Wn=n("br",null,null,-1),Qn=n("br",null,null,-1),Xn=v(" Current Status/\u5F53\u524D\u72B6\u6001: "),Zn=n("br",null,null,-1),eo=n("img",{src:"https://app.travis-ci.com/050644zf/ArknightsStoryTextReader.svg?branch=master"},null,-1),to=n("img",{src:"https://github.com/050644zf/ArknightsStoryTextReader/actions/workflows/ASTRAutoUpdater.yml/badge.svg"},null,-1),no=n("br",null,null,-1),oo=n("br",null,null,-1),so=v(" If you like this project, please give me a star "),ro=n("a",{href:"https://github.com/050644zf/ArknightsStoryTextReader"},"here",-1),io=v("!"),ao=n("br",null,null,-1),lo=v(" \u5982\u679C\u60A8\u559C\u6B22\u672C\u9879\u76EE\uFF0C\u8BF7\u5728"),co=n("a",{href:"https://github.com/050644zf/ArknightsStoryTextReader"},"\u8FD9\u91CC",-1),uo=v("\u7ED9\u6211\u4E00\u4E2Astar\uFF01 ");function po(o,t,s,l,e,r){const a=m("Header"),d=m("Menu"),h=m("Settings"),f=m("Menupage"),S=m("Content"),L=m("Topbtn");return i(),c(x,null,[C(a),e.storyFile?(i(),k(d,{key:0})):T("",!0),C(h),e.storyFile?T("",!0):(i(),k(f,{key:1})),e.storyFile?(i(),k(S,{key:2})):T("",!0),C(L),qn,n("div",Yn,[Gn,n("div",Kn,[v(" Last Update/\u6700\u540E\u66F4\u65B0 (UTC): "+p(r.dateFormatter(e.latestUpdate)),1),Wn,Qn,Xn,Zn,eo,to,no,oo,so,ro,io,ao,lo,co,uo])])],64)}var ho=_(Hn,[["render",po]]);D(ho).mount("#ASTR");console.log(u.urlParams.get("f"));
